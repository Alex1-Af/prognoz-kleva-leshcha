(()=>{"use strict";class t{static createIconGroup(t,e){return{description:t,icon:`${e}d`,nightIcon:`${e}n`}}static weatherIcons={0:t.createIconGroup("–Ø—Å–Ω–æ","01"),1:t.createIconGroup("–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —è—Å–Ω–æ","02"),2:t.createIconGroup("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å","03"),3:t.createIconGroup("–ü–∞—Å–º—É—Ä–Ω–æ","04"),45:t.createIconGroup("–¢—É–º–∞–Ω","50"),48:t.createIconGroup("–ò–∑–º–æ—Ä–æ–∑—å","50"),51:t.createIconGroup("–ú–æ—Ä–æ—Å—å: —Å–ª–∞–±–∞—è","09"),53:t.createIconGroup("–ú–æ—Ä–æ—Å—å: —É–º–µ—Ä–µ–Ω–Ω–∞—è","09"),55:t.createIconGroup("–ú–æ—Ä–æ—Å—å: —Å–∏–ª—å–Ω–∞—è","09"),56:t.createIconGroup("–õ–µ–¥—è–Ω–∞—è –º–æ—Ä–æ—Å—å: —Å–ª–∞–±–∞—è","13"),57:t.createIconGroup("–õ–µ–¥—è–Ω–∞—è –º–æ—Ä–æ—Å—å: —Å–∏–ª—å–Ω–∞—è","13"),61:t.createIconGroup("–î–æ–∂–¥—å: —Å–ª–∞–±—ã–π","10"),63:t.createIconGroup("–î–æ–∂–¥—å: —É–º–µ—Ä–µ–Ω–Ω—ã–π","10"),65:t.createIconGroup("–î–æ–∂–¥—å: —Å–∏–ª—å–Ω—ã–π","10"),66:t.createIconGroup("–õ–µ–¥—è–Ω–æ–π –¥–æ–∂–¥—å: —Å–ª–∞–±—ã–π","13"),67:t.createIconGroup("–õ–µ–¥—è–Ω–æ–π –¥–æ–∂–¥—å: —Å–∏–ª—å–Ω—ã–π","13"),71:t.createIconGroup("–°–Ω–µ–≥: —Å–ª–∞–±—ã–π","13"),73:t.createIconGroup("–°–Ω–µ–≥: —É–º–µ—Ä–µ–Ω–Ω—ã–π","13"),75:t.createIconGroup("–°–Ω–µ–≥: —Å–∏–ª—å–Ω—ã–π","13"),77:t.createIconGroup("–°–Ω–µ–∂–Ω—ã–µ –∑–µ—Ä–Ω–∞","13"),80:t.createIconGroup("–õ–∏–≤–µ–Ω—å: —Å–ª–∞–±—ã–π","09"),81:t.createIconGroup("–õ–∏–≤–µ–Ω—å: —É–º–µ—Ä–µ–Ω–Ω—ã–π","09"),82:t.createIconGroup("–õ–∏–≤–µ–Ω—å: —Å–∏–ª—å–Ω—ã–π","09"),85:t.createIconGroup("–°–Ω–µ–≥–æ–ø–∞–¥: —Å–ª–∞–±—ã–π","13"),86:t.createIconGroup("–°–Ω–µ–≥–æ–ø–∞–¥: —Å–∏–ª—å–Ω—ã–π","13"),95:t.createIconGroup("–ì—Ä–æ–∑–∞: —Å–ª–∞–±–∞—è","11"),96:t.createIconGroup("–ì—Ä–æ–∑–∞ —Å –≥—Ä–∞–¥–æ–º: —Å–ª–∞–±–∞—è","11"),99:t.createIconGroup("–ì—Ä–æ–∑–∞ —Å –≥—Ä–∞–¥–æ–º: —Å–∏–ª—å–Ω–∞—è","11")};static getIconData(t){const e=String(t);return this.weatherIcons[e]||{description:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",icon:"unknown",nightIcon:"unknown"}}static getDominantWeatherDescription(t,e){if(!t||!t.length)return{type:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö",description:"",icon:"",iconShow:"",descriptionShow:""};const n={–Ø—Å–Ω–æ:[0,1],–û–±–ª–∞—á–Ω–æ:[2,3],–¢—É–º–∞–Ω:[45,48],–ú–æ—Ä–æ—Å—å:[51,53,55,56,57],–î–æ–∂–¥—å:[61,63,65,66,67,80,81,82],–°–Ω–µ–≥:[71,73,75,77,85,86],–ì—Ä–æ–∑–∞:[95,96,99]},i=t.reduce(((t,e)=>{const n=e.code;return"number"==typeof n&&(t[n]=(t[n]||0)+1),t}),{});let r=null,a=0;for(const[t,e]of Object.entries(i)){const n=Number(t);e>a&&(r=n,a=e)}let s="–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ";for(const[t,e]of Object.entries(n))if(e.includes(r)){s=t;break}const o=t.find((t=>t.code===r)),c=this.weatherIcons[String(e)];return{type:s,description:o?.description||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",icon:o?.icon||"unknown",iconShow:c?.icon||"unknown",descriptionShow:c?.description||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"}}static getWeatherType(t){const e=t.code,n=this.weatherIcons[String(e)];return n?.description||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"}static getWeatherDescription(t){return t.description||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"}}class e{static calcTempStats(t,e){return t.length?{avg:e(t.reduce(((t,e)=>t+e),0)/t.length),min:e(Math.min(...t)),max:e(Math.max(...t)),change:e(t[t.length-1]-t[0])}:{avg:null,min:null,max:null,change:null}}static calcPressureStats(t,e){if(!t.length)return{avg:null,min:null,max:null,change:0,isStable:!1};const n=e(t.reduce(((t,e)=>t+e),0)/t.length),i=e(Math.min(...t)),r=e(Math.max(...t));return{avg:n,min:i,max:r,change:t.length>1?e(t[t.length-1]-t[0]):0,isStable:r-i<2}}static degreesToCardinal(t){return["–° ‚Üë","–°–í ‚Üó","–í ‚Üí","–Æ–í ‚Üò","–Æ ‚Üì","–Æ–ó ‚Üô","–ó ‚Üê","–°–ó ‚Üñ"][Math.round(t%360/45)%8]}static calcWindStats(t,e=null){const n={avgSpeed:0,avgSpeedStrongWind:0,maxSpeed:0,mainDirection:null,strongWindOnly:!1};if(!Array.isArray(t)||0===t.length)return n;const i=t.filter((t=>t?.speed>=3));return 0===i.length?{...n,avgSpeed:this.round(t.reduce(((t,e)=>t+(e?.speed||0)),0)/t.length),mainDirection:this.degreesToCardinal(e)}:{avgSpeed:this.round(t.reduce(((t,e)=>t+(e?.speed||0)),0)/t.length),avgSpeedStrongWind:this.round(i.reduce(((t,e)=>t+(e?.speed||0)),0)/i.length),maxSpeed:this.round(Math.max(...i.map((t=>t?.speed||0)))),mainDirection:this.degreesToCardinal(e),strongWindOnly:!0}}static calcPrecipStats(t){return null==t?null:parseFloat(t.toFixed(1))}static calcWeather(e,n){return t.getDominantWeatherDescription(e,n)}static round(t,e=0){return parseFloat(t.toFixed(e))}static findExtremes(t){if(!t?.length)return null;const e=t.reduce(((t,e)=>t.tempMax>e.tempMax?t:e)),n=t.reduce(((t,e)=>t.tempMin<e.tempMin?t:e)),i=t.reduce(((t,e)=>t.precipitation>e.precipitation?t:e));return{warmest:e,coldest:n,windiest:t.reduce(((t,e)=>t.windMax>e.windMax?t:e)),wettest:i}}static getRoundedHourTime(){const t=new Date;let e=t.getHours();return t.getMinutes()>=30&&(e+=1),e%=24,`${e.toString().padStart(2,"0")}:00`}}const n=class{constructor(t){this.rawData=t,this.calculator=e,this.processedData={daily:{},stats:{}}}process(){if(!this.validateData())throw new Error("Invalid weather data format");return this.groupDataByDays(),this.calculatePeriodStatistics(),this.processedData}validateData(){return this.rawData&&this.rawData.hourly&&Array.isArray(this.rawData.hourly.time)}groupDataByDays(){this.rawData.hourly.time.forEach(((t,e)=>{const n=t.split("T")[0];this.processedData.daily[n]||this.initDayData(n),this.addHourData(n,e)}))}initDayData(t){this.processedData.daily[t]={date:t,hours:[],temps:[],pressures:[],precipitations:[],winds:[],weatherCodes:[]}}addHourData(t,e){const n=this.processedData.daily[t],i=this.rawData.hourly,r=i.time[e],a=i.temperature_2m[e],s=i.surface_pressure[e],o=i.precipitation[e],c=i.windspeed_10m[e],l=i.winddirection_10m[e],d=i.weathercode[e],h=this.getWeatherCodeEntry(d,r);null!==a&&n.temps.push(a),null!==s&&n.pressures.push(this.calculator.round(.75006*s)),null!==o&&n.precipitations.push(o),null!==c&&null!==l&&n.winds.push({speed:this.calculator.round(.27778*c),direction:l}),null!==d&&n.weatherCodes.push(h),n.hours.push({time:r,temp:a,precipitations:o,pressure:null!==s?this.calculator.round(.75006*s):null,winds:null!==c&&null!==l?{speed:this.calculator.round(.27778*c),direction:l}:null,weatherCodes:h})}getWeatherCodeEntry(e,n){const i=t.getIconData(e);return{code:e,description:i.description,icon:i.icon,nightIcon:i.nightIcon,time:n}}calculatePeriodStatistics(){Object.entries(this.processedData.daily).forEach((([t,e])=>{const n=this.getDailyData(t);this.processedData.stats[t]={temp:this.calculator.calcTempStats(e.temps,this.calculator.round),pressure:this.calculator.calcPressureStats(e.pressures,this.calculator.round),winds:this.calculator.calcWindStats(e.winds,n?.windDirection,this.calculator.round),precipitations:this.calculator.calcPrecipStats(n?.precipitation),weatherCodes:this.calculator.calcWeather(e.weatherCodes,n?.weatherCode)}}))}getDailyData(t){if(!this.rawData.daily?.time)return null;const e=this.rawData.daily.time.indexOf(t);return-1===e?null:{weatherCode:this.rawData.daily.weathercode?.[e],precipitation:this.rawData.daily.precipitation_sum?.[e],windDirection:this.rawData.daily.winddirection_10m_dominant?.[e]}}getDayData(t){return this.processedData.daily[t]}},i=class extends n{constructor(t){super(t),this.processedData={daily:{},stats:{},statsTotal:{}}}processHourly(e,n){const i=[];if(!this.validateData())throw new Error("Invalid weather data format");const r=this.rawData.hourly;for(let e=0;e<Math.min(r.time.length,24);e++){const n=r.time[e],a=r.weathercode[e],s=t.getIconData(a),o=this.calculator.degreesToCardinal(r.winddirection_10m[e]);i.push({time:n,temp:this.calculator.round(r.temperature_2m[e]),precipitations:this.calculator.round(r.precipitation[e],1),pressure:this.calculator.round(.75006*r.surface_pressure[e]),winds:{speed:this.calculator.round(.27778*r.windspeed_10m[e]),direction:o},weatherCodes:{code:a,description:s.description,icon:s.icon,nightIcon:s.nightIcon,time:n}})}const a=t.getIconData(e.weathercode),s=this.calculator.degreesToCardinal(e.winddirection_10m),o=this.calculator.round(e.temperature_2m)-n.temp.avg,c=this.calculator.round(.75006*e.surface_pressure)-n.pressure.avg;return{current:{apparent_temperature:this.calculator.round(e.apparent_temperature),pressure:this.calculator.round(.75006*e.surface_pressure),pressureChange:c,temp:this.calculator.round(e.temperature_2m),tempChange:o,humidity:e.relativehumidity_2m,winds:{speed:this.calculator.round(.27778*e.windspeed_10m),direction:s},weatherCodes:{code:e.weathercode,description:a.description,icon:a.icon,nightIcon:a.nightIcon}},hourly:i}}initDailyData(t){this.processedData.statsTotal[t]={date:t,temp_max:null,temp_min:null,precipitations:null,winds:[],weatherCodes:[]}}addDailyData(e,n){const i=this.rawData.daily,r=this.processedData.statsTotal[e],a=i.weathercode[n],s=t.getIconData(a);null!==i.windspeed_10m_max[n]&&null!==i.winddirection_10m_dominant[n]&&r.winds.push({speed:this.calculator.round(.27778*i.windspeed_10m_max[n]),direction:this.calculator.degreesToCardinal(i.winddirection_10m_dominant[n])}),null!==i.precipitation_sum[n]&&(r.precipitations=this.calculator.round(i.precipitation_sum[n])),null!==i.temperature_2m_max[n]&&(r.temp_max=this.calculator.round(i.temperature_2m_max[n])),null!==i.temperature_2m_min[n]&&(r.temp_min=this.calculator.round(i.temperature_2m_min[n])),i.weathercode&&null!==i.weathercode[n]&&r.weatherCodes.push({code:a,description:s.description,icon:s.icon,nightIcon:s.nightIcon})}process(){return super.process()}validateData(){return super.validateData()}groupDataByDays(){super.groupDataByDays(),this.rawData.daily.time.forEach(((t,e)=>{this.processedData.statsTotal[t]||this.initDailyData(t),this.addDailyData(t,e)}))}initDayData(t){super.initDayData(t)}addHourData(t,e){super.addHourData(t,e)}calculatePeriodStatistics(){super.calculatePeriodStatistics()}getDailyData(t){return super.getDailyData(t)}getDayData(t){return super.getDayData(t)}},r=class extends n{constructor(t){super(t),this.processedData={daily:{},stats:{},totalstats:{},extremes:{}}}calculateTotalStats(){this.dataTotalStats=Object.entries(this.processedData.stats),this.processedData.totalstats={totalPrecipitations:this.calcTotalPrecipitations(),totalTemp:this.calcTotalTempStats(),totalPressure:this.calcTotalPressureStats()}}calcTotalPrecipitations(){const t=this.reduceCustoms((t=>t[1].precipitations));return this.round(t)}calcTotalTempStats(){const t=this.round(this.reduceCustoms((t=>t[1].temp.avg))/this.dataTotalStats.length),e=this.round(Math.min(...this.dataTotalStats.map((t=>t[1].temp.avg)))),n=this.round(Math.max(...this.dataTotalStats.map((t=>t[1].temp.avg)))),i=this.dataTotalStats[0][1].temp.avg,r=this.dataTotalStats[this.dataTotalStats.length-1][1].temp.avg;return{avg:t,min:e,max:n,change:this.round(i-r)}}calcTotalPressureStats(){const t=this.round(this.reduceCustoms((t=>t[1].pressure.avg))/this.dataTotalStats.length),e=this.round(Math.min(...this.dataTotalStats.map((t=>t[1].pressure.avg)))),n=this.round(Math.max(...this.dataTotalStats.map((t=>t[1].pressure.avg))));return{avg:t,min:e,max:n,change:this.round(n-e)}}reduceCustoms(t){return this.dataTotalStats.reduce(((e,n)=>e+t(n)),0)}round(t,e=0){return parseFloat(t.toFixed(e))}process(){const t=super.process();return this.calculateTotalStats(),t}validateData(){return super.validateData()}groupDataByDays(){super.groupDataByDays()}initDayData(t){super.initDayData(t)}addHourData(t,e){super.addHourData(t,e)}calculatePeriodStatistics(){super.calculatePeriodStatistics()}getDailyData(t){return super.getDailyData(t)}getDayData(t){return super.getDayData(t)}};class a{constructor(t){this.dailyContainer=document.getElementById("weather-container"),this.processedData=t,this.daysStats=Object.entries(this.processedData.stats)}renderHistoricalDailyWeather(){this.dailyContainer.innerHTML="",this.renderHistoricalDailyStats(),this.renderHistoricalTotalStats()}renderHistoricalDailyStats(){for(const[t,e]of this.daysStats){const n=document.createElement("div");n.className="day-card",n.innerHTML=`\n\t\t  <div class="day-header">\n\t\t\t <div class="date">${t}</div>\n\t\t\t ${e.weatherCodes.icon?`\n\t\t\t <div class="weather-icon-container">\n\t\t\t\t <img src="https://openweathermap.org/img/wn/${"unknown"!==e.weatherCodes.iconShow?e.weatherCodes.iconShow:e.weatherCodes.icon}@2x.png" \n\t\t\t\t alt="${e.weatherCodes.type}" class="weather-icon">\n\t\t\t\t <div class="weather-desc">${"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"!==e.weatherCodes.descriptionShow?e.weatherCodes.descriptionShow:e.weatherCodes.description}</div>\n\t\t\t </div>`:""}\n\t\t\t \n\t\t\t \n\t\t\t \n\t\t  </div>\n\t\t  <div class="weather-details">\n\t\t\t ${e.temp.avg?`\n\t\t\t <div class="detail-card temperature">\n\t\t\t\t<div class="detail-label">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</div>\n\t\t\t\t<div class="detail-value">${e.temp.min}¬∞ - ${e.temp.max}¬∞</div>\n\t\t\t\t\n\t\t\t\t<div class="detail-value">\n\t\t\t\t<span class="detail-label">–°—Ä–µ–¥–Ω—è—è</span> <span class="temp-avg-history">${e.temp.avg}¬∞</span>\n\t\t\t\t${e.temp.change?`\n\t\t\t\t<div class="detail-change ${e.temp.change>0?"positive":"negative"}">\n\t\t\t\t  ${e.temp.change>0?"‚Üë":"‚Üì"} ${Math.abs(e.temp.change)}¬∞\n\t\t\t\t</div>`:""}\n\t\t\t\t</div>\n\t\t\t </div>`:""}\n\n\t\t\n\t\t\t \n\t\t\t \n\t\t\t ${e.precipitations?`\n\t\t\t <div class="detail-card precipitation">\n\t\t\t\t<div class="detail-label">–û—Å–∞–¥–∫–∏ üíß</div>\n\t\t\t\t<div class="detail-value">${e.precipitations} –º–º</div>\n\t\t\t </div>`:""}\n\t\t\t \n\t\t\t ${e.pressure.avg?`\n\t\t\t <div class="detail-card pressure">\n\t\t\t\t<div class="detail-label">–î–∞–≤–ª–µ–Ω–∏–µ</div>\n\t\t\t\t<div class="detail-value">${e.pressure.avg}\n\t\t\t\t<span class="detail-unit">–º–º —Ä—Ç.—Å—Ç.</span></div>\n\t\t\t\t${e.pressure.change?`\n\t\t\t\t<div class="detail-change ${e.pressure.change>0?"positive":"negative"}">\n\t\t\t\t  ${e.pressure.change>0?"‚Üë":"‚Üì"} ${Math.abs(e.pressure.change)}\n\t\t\t\t</div>`:""}\n\t\t\t </div>`:""}\n\t\t\t \n\t\t\t ${e.winds.avgSpeed?`\n\t\t\t <div class="detail-card wind">\n\t\t\t\t<div class="detail-label">–í–µ—Ç–µ—Ä</div>\n\t\t\t\t<div class="detail-value">${e.winds.avgSpeed} –º/—Å</div>\n\t\t\t\t<div class="detail-unit"> ${e.winds.mainDirection||""}</div>\n\t\t\t </div>`:""}\n\t\t  </div>\n\t\t`,this.dailyContainer.appendChild(n)}}renderHistoricalTotalStats(){const t=this.processedData.totalstats,e=document.createElement("div");e.className="day-total",e.innerHTML=`\n\t\t\t  <h3>üìä –¢–µ–Ω–¥–µ–Ω—Ü–∏–∏ –∑–∞ ${this.daysStats.length} –¥–Ω–µ–π</h3>\n\t\t\t  ${t.totalPressure.change?`\n\t\t\t  <div class="trend-item">\n\t\t\t\t\t<span>–°—Ä–µ–¥–Ω–µ–µ –¥–∞–≤–ª–µ–Ω–∏–µ:</span>\n\t\t\t\t\t<span>${t.totalPressure.avg} –º–º —Ä—Ç.—Å—Ç.</span>\n\t\t\t\t\t<span class="detail-change  ${t.totalPressure.change>0?"positive":"negative"}">${t.totalPressure.change>0?"‚Üë":"‚Üì"} ${t.totalPressure.change}–º–º —Ä—Ç.—Å—Ç.</span>\n\t\t\t  </div>`:""}\n\t\t\t  <div class="trend-item">\n\t\t\t\t\t<span>üíß –í—Å–µ–≥–æ –æ—Å–∞–¥–∫–æ–≤:</span>\n\t\t\t\t\t<span>${t.totalPrecipitations} –º–º</span>\n\t\t\t  </div>\n\t\t\t  <div class="trend-item">\n\t\t\t\t\t<span>–°—Ä–µ–¥–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞:</span>\n\t\t\t\t\t<span>${t.totalTemp.avg}¬∞C</span>\n\t\t\t\t\t<span class="detail-change  ${t.totalTemp.change>0?"positive":"negative"}">${t.totalTemp.change>0?"‚Üë":"‚Üì"} ${t.totalTemp.change}¬∞C</span>\n\t\t\t  </div>\n\t\t `,this.dailyContainer.appendChild(e)}}class s{static getMoonPhase(t=new Date){const e=t.getUTCFullYear(),n=t.getUTCMonth()+1,i=t.getUTCDate(),r=t.getUTCHours();n<3&&(e--,n+=12);const a=Math.floor(e/100),s=(2-a+Math.floor(a/4)+i+Math.floor(365.25*(e+4716))+Math.floor(30.6001*(n+1))-1524.5+r/24-2451550.1)/29.53058867%1;return s<0?s+1:s}static getLunarDay(t=new Date){const e=this.getMoonPhase(t);let n=Math.floor(29.53058867*e)+1;return n<1&&(n=1),n>30&&(n=30),n}static getMoonPhaseInfo(t){const e=29.53058867,n=15/e,i=13.75/e;return[{icon:"üåë",name:"–ù–æ–≤–æ–ª—É–Ω–∏–µ",range:[0,.02]},{icon:"üåí",name:"–ú–æ–ª–æ–¥–∞—è –ª—É–Ω–∞",range:[.02,.23]},{icon:"üåì",name:"–ü–µ—Ä–≤–∞—è —á–µ—Ç–≤–µ—Ä—Ç—å",range:[.23,.27]},{icon:"üåî",name:"–†–∞—Å—Ç—É—â–∞—è –ª—É–Ω–∞",range:[.27,i]},{icon:"üåï",name:"–ü–æ–ª–Ω–æ–ª—É–Ω–∏–µ",range:[i,n]},{icon:"üåñ",name:"–£–±—ã–≤–∞—é—â–∞—è –ª—É–Ω–∞",range:[n,.73]},{icon:"üåó",name:"–ü–æ—Å–ª–µ–¥–Ω—è—è —á–µ—Ç–≤–µ—Ä—Ç—å",range:[.73,.77]},{icon:"üåò",name:"–°—Ç–∞—Ä–∞—è –ª—É–Ω–∞",range:[.77,.97]},{icon:"üåë",name:"–ù–æ–≤–æ–ª—É–Ω–∏–µ",range:[.97,1]}].find((e=>t>=e.range[0]&&t<e.range[1]))}}class o{constructor(t,e){this.data=t,this.precipitation=e,this.elements={currentTemp:document.getElementById("current-temp"),currentDesc:document.getElementById("current-desc"),feelsLike:document.getElementById("feels-like"),humidity:document.getElementById("humidity"),wind:document.getElementById("wind"),pressure:document.getElementById("pressure"),currentIcon:document.getElementById("current-icon"),iconMoon:document.getElementById("current-moon-icon"),moonPhase:document.getElementById("current-moon-phase"),moonPhaseContainer:document.getElementById("moon-phase")}}renderCurrentWeather(){const t=s.getMoonPhase(),{icon:n,name:i}=s.getMoonPhaseInfo(t),r=`https://openweathermap.org/img/wn/${["00:00","01:00","02:00","03:00","21:00","22:00","23:00"].includes(e.getRoundedHourTime())?this.data.weatherCodes.nightIcon:this.data.weatherCodes.icon}@2x.png`,a=`<span class="current-temp">${this.data.temp}¬∞C\n\t\t${this.data.tempChange?`\n\t\t<span class="detail-change ${this.data.tempChange>0?"positive":"negative"}">\n\t\t  ${this.data.tempChange>0?"‚Üë":"‚Üì"} ${this.data.tempChange}¬∞\n\t\t</span>`:""} \n\t\t</span>`,o=`<span class="current-pressure">${this.data.pressure} –º–º —Ä—Ç.—Å—Ç.\n\t\t${this.data.pressureChange?`\n\t\t<span class="detail-change ${this.data.pressureChange>0?"positive":"negative"}">\n\t\t  ${this.data.pressureChange>0?"‚Üë":"‚Üì"} ${this.data.pressureChange}¬∞\n\t\t</span>`:""} \n\t\t</span>`,c=document.createElement("div");c.className="current-desc precipitation-item",c.textContent=`üíß ${this.precipitation} –º–º`,this.elements.iconMoon.textContent=n,this.elements.moonPhase.textContent=i,this.elements.currentTemp.innerHTML=a,this.elements.currentDesc.textContent=this.data.weatherCodes.description,this.elements.feelsLike.textContent=`${this.data.apparent_temperature}¬∞C`,this.elements.humidity.textContent=`${this.data.humidity}%`,this.elements.pressure.innerHTML=o,this.elements.wind.textContent=`${this.data.winds.speed} –º/—Å, ${this.data.winds.direction}`,this.elements.currentIcon.innerHTML=`<img src="${r}" alt="${this.data.weatherCodes.description}">`,this.precipitation&&this.elements.moonPhaseContainer.insertAdjacentHTML("afterend",`<div class="precipitation-item">–û—Å–∞–¥–∫–∏ üíß ${this.precipitation} –º–º</div>`)}}class c{constructor(t){this.hourlyContainer=document.getElementById("hourly-forecast"),this.processedData=t}renderHourlyWeather(){this.hourlyContainer.innerHTML="";const t=["00:00","03:00","06:00","09:00","12:00","15:00","18:00","21:00"];this.showTimeDate=this.processedData.hourly.filter((e=>{const n=e.time.split("T")[1];return t.includes(n)})),this.showTimeDate.forEach((t=>{const e=document.createElement("div");e.className="hourly-item",e.innerHTML=this.createHourlyItemHTML(t),this.hourlyContainer.appendChild(e)}))}createHourlyItemHTML(t){const e=t.time.split("T")[1],n=t.temp,i=t.precipitations,r=`https://openweathermap.org/img/wn/${["00:00","03:00","21:00"].includes(e)?t.weatherCodes.nightIcon:t.weatherCodes.icon}.png`,a=`${t.winds.speed} –º/—Å,\n\t\t ${t.winds.direction}`,s=`${t.pressure} –º–º —Ä—Ç.—Å—Ç.`;return`\n\t\t <div class="hourly-time">${e}</div>\n\t\t <div class="hourly-icon"><img src="${r}" class="weather-icon" alt="${t.weatherCodes.description}"></div>\n\t\t <div class="hourly-temp">${n}¬∞C</div>\n\t\t \x3c!--<div class="hourly-desc">${t.weatherCodes.description}</div>--\x3e\n\t\t <div class="hourly-wind">${a}</div>\n\t\t <div class="hourly-pressure">${s}</div>\n\t\t ${i?`\n\t\t <div class="hourly-pressure">üíß ${i} –º–º\n\t\t </div>`:""}\n\t  `}}class l{constructor(t){this.dailyContainer=document.getElementById("daily-forecast"),this.processedData=t,this.daysStats=Object.entries(this.processedData.stats)}renderDailyWeather(){this.dailyContainer.innerHTML="",this.daysStats.forEach((([t,e])=>{const n=new Date(t+"T00:00:00"),i=n.toLocaleDateString("ru-RU",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"Europe/Kiev"}),r=s.getMoonPhase(n),{icon:a,name:o}=s.getMoonPhaseInfo(r),c=document.createElement("div");c.className="daily-item",c.innerHTML=`\n\t\t\t\t  <div class="daily-day">${i}</div>\n\t\t\t\t  <div class="daily-icon"><img src="https://openweathermap.org/img/wn/${e.weatherCodes.iconShow}.png" class="weather-icon" alt="${e.weatherCodes.descriptionShow}"></div>\n\t\t\t\t  <div class="daily-temp">${e.temp.min}¬∞ - ${e.temp.max}¬∞\n\t\t\t\t  </div>\n\t\t\t\t  <div class="daily-temp-avg">–°—Ä–µ–¥–Ω—è—è <span class="temp-avg"> ${e.temp.avg}¬∞</span>\n\t\t\t\t  ${e.temp.change?`\n\t\t\t\t  <span class="detail-change ${e.temp.change>0?"positive":"negative"}">\n\t\t\t\t\t ${e.temp.change>0?"‚Üë":"‚Üì"} ${Math.abs(e.temp.change)}¬∞\n\t\t\t\t  </span>`:""} \n\t\t\t\t  </div>\n\n\t\t\t\t  <div>${e.weatherCodes.descriptionShow}</div>\n\t\t\t\t  <div class="hourly-wind">${e.winds.avgSpeed} –º/—Å, ${e.winds.mainDirection||""}</div>\n\t\t\t\t  <div class="hourly-pressure">${e.pressure.avg} –º–º —Ä—Ç.—Å—Ç.\n\t\t\t\t  ${e.pressure.change?`\n\t\t\t\t  <span class="detail-change ${e.pressure.change>0?"positive":"negative"}">\n\t\t\t\t  ${e.pressure.change>0?"‚Üë":"‚Üì"} ${Math.abs(e.pressure.change)} \n\t\t\t\t  </span>`:""} \n\t\t\t\t  <div class="daily-moon">\n\t\t\t\t\t\t<div class="daily-moon-icon">${a}</div>\n\t\t\t\t\t\t<div>${o}</div>\n\t\t\t\t  </div>\n\t\t\t\t  ${e.precipitations?`\n\t\t\t\t  <div class="hourly-pressure">–û—Å–∞–¥–∫–∏ üíß ${e.precipitations} –º–º</div>`:""} \n\t\t\t\t `,this.dailyContainer.appendChild(c)}))}displayMoonPhase(){const t=s.getMoonPhase(),{icon:e,name:n}=s.getMoonPhaseInfo(t);this.elements.iconMoon.textContent=e,this.elements.moonPhase.textContent=n}}class d{renderHistorical(t){return new a(t).renderHistoricalDailyWeather()}renderCurrent(t,e){return new o(t,e).renderCurrentWeather()}renderHourly(t){return new c(t).renderHourlyWeather()}renderDaily(t){return new l(t).renderDailyWeather()}}class h{constructor(){this.dailyData={},this.renderer=new d}updateHistoricalData(t){this.processorHistoricalData=new r(t),this.processedHistData=this.processorHistoricalData.process();const e=Object.values(this.processedHistData.stats);this.lastHistoricalDay=e[e.length-1],this.renderData=this.renderer.renderHistorical(this.processedHistData)}updateDailyData(t){this.rawData={daily:t.forecast.daily,hourly:t.forecast.hourly},this.processorDailyData=new i(this.rawData),this.data=this.processorDailyData.process();const e=t.current,n=t.forecast.daily.precipitation_sum[0],{todayData:r,forecastWindow:a}=this.extractProcessedForecastWindow(this.data,e);this.hourlyData=this.processorDailyData.processHourly(e,this.lastHistoricalDay),this.renderCurrentData=this.renderer.renderCurrent(this.hourlyData.current,n),this.renderHourlyData=this.renderer.renderHourly(this.hourlyData),this.renderData=this.renderer.renderDaily(a)}extractProcessedForecastWindow(t,e){const n=Object.keys(t.daily),i=n[0],r=n.slice(1,6),a={daily:{[i]:{...t.daily[i]}},stats:{[i]:t.stats[i]}},s={daily:{},stats:{}};r.forEach((e=>{const n=t.daily[e];s.daily[e]={...n,hours:Array.isArray(n.hours)?n.hours:[]},s.stats[e]=t.stats[e]}));const o={extremes:t.extremes,statsTotal:t.statsTotal,current:e};return{todayData:{...a,...o},forecastWindow:{...s,...o}}}}class u{static DAYS=6;static DAYS_ARCHIVE=5;static DEFAULT_LOCATION={latitude:50.45,longitude:30.52,timezone:"Europe/Kyiv"};static BASE_URL="https://api.open-meteo.com/v1/forecast";static CURRENT_PARAMS=["temperature_2m","apparent_temperature","relativehumidity_2m","windspeed_10m","winddirection_10m","surface_pressure","weathercode"].join(",");static COMMON_PARAMS=["temperature_2m","surface_pressure","weathercode","windspeed_10m","winddirection_10m","precipitation"].join(",");static DAILY_PARAMS=["weathercode","temperature_2m_max","temperature_2m_min","precipitation_sum","windspeed_10m_max","windgusts_10m_max","winddirection_10m_dominant"].join(",");static formatDate(t){return new Date(Date.now()-864e5*t).toISOString().split("T")[0]}static buildArchiveUrl(){return`https://archive-api.open-meteo.com/v1/archive?${new URLSearchParams({...this.DEFAULT_LOCATION,start_date:this.formatDate(this.DAYS_ARCHIVE),end_date:this.formatDate(1),hourly:this.COMMON_PARAMS,daily:this.DAILY_PARAMS})}`}static buildWeatherUrl(){const t=new URLSearchParams({...this.DEFAULT_LOCATION,forecast_days:this.DAYS.toString(),current:this.CURRENT_PARAMS,hourly:this.COMMON_PARAMS,daily:this.DAILY_PARAMS});return`${this.BASE_URL}?${t}`}}class m{static async fetchWeather(){const t=u.buildWeatherUrl(),e=await fetch(t);if(!e.ok)throw new Error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ–≥–Ω–æ–∑–∞ –ø–æ–≥–æ–¥—ã");const n=await e.json();return{current:n.current,forecast:{hourly:n.hourly,daily:n.daily}}}static async fetchHistoricalData(){const t=u.buildArchiveUrl(),e=await fetch(t);if(!e.ok)throw new Error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö");return await e.json()}}class g{static async loadJSON(t){const e=`./files/${t}`;try{const n=await fetch(e);if(!n.ok)throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ ${t}: ${n.statusText}`);return await n.json()}catch(e){throw new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å ${t}: ${e.message}`)}}static async loadAll(){try{const[t,e,n]=await Promise.all([this.loadJSON("calendar.json"),this.loadJSON("calendar-moon.json"),this.loadJSON("terms-moon.json")]);return{calendar:t,moonCalendar:e,moonTerms:n}}catch(t){throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø—Ä–∞–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö: ${t.message}`)}}}class p{static getSeason(t){const e=new Date(t).getMonth()+1;return e>=3&&e<=5?"spring":e>=6&&e<=8?"summer":e>=9&&e<=11?"autumn":"winter"}static calculate(t){if(t)return{night:t.slice(0,6),morning:t.slice(6,12),day:t.slice(12,18),evening:t.slice(18,24)}}static generateTimeForPeriod(t,e,n){const i={night:{start:0,count:6},morning:{start:6,count:6},day:{start:12,count:6},evening:{start:18,count:6}}[n];if(!i)throw new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥: "+n);const r=i.start+t;return`${String(r).padStart(2,"0")}:00`}static calculateAvgSpeed(t){return t&&0!==t.length?(t.reduce(((t,e)=>t+e.speed),0)/t.length).toFixed(1):"0.0"}static getDominantDirection(t){const e=t.reduce(((t,{description:e})=>{const n=e.split(" ‚Äî ")[0];return t[n]=(t[n]||0)+1,t}),{}),n=Object.entries(e).sort(((t,e)=>e[1]-t[1]));return n.length>0?n[0][0]:"–ù/–î"}static findBestTimeEntry(t){return t&&0!==t.length?t.reduce(((t,e)=>e.evaluation.score>t.evaluation.score?e:t)):{time:"00:00",evaluation:{score:0,description:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"}}}static formatTimeBasic(t){if(!t)return"--:--";const[e,n]=t.split(":");return`${e.padStart(2,"0")}:${(n||"00").padStart(2,"0")}`}static evaluateBreamWind(t,n,i=null,r=null,a,s=null,o,c){const l=r?n-r:0,d=i?Math.abs(t-i):0,h=s?a-s:0,u=parseInt(c.split(":")[0],10),m=e.degreesToCardinal(t),g=["–Æ ‚Üì","–Æ–ó ‚Üô","–ó ‚Üê"].includes(m),p=["–°–ó ‚Üñ","–Æ–í ‚Üò"].includes(m),y=["–° ‚Üë","–°–í ‚Üó","–í ‚Üí"].includes(m),w=[],v=[];let f=0,$="";$=g?"–ë–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç—Ä–∞":p?"–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç—Ä–∞":y?"–ù–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç—Ä–∞":"–Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ",w.push($);let D="";if(D=n<=1?"—à—Ç–∏–ª—å":n<=3?"–æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å":n<=6?"—É–º–µ—Ä–µ–Ω–Ω—ã–π –≤–µ—Ç–µ—Ä":"üåä —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω—ã–π –≤–µ—Ç–µ—Ä",w.push(D),g&&n>1&&n<=3)f=4;else if(g&&n<=1)switch(!0){case u>=18&&u<=23:f=o?4:3;break;case u>=4&&u<=10:f=3;break;case u>=11&&u<=17:f=2;break;default:f=3}else if(g&&n>3&&n<=6)f=3;else if(g&&n>6)f=1;else if(p&&n>1&&n<=3)f=3;else if(p&&n<=1)switch(!0){case o&&u>=18&&u<=23:f=o?4:3;break;case u>=4&&u<=10:f=3;break;case u>=11&&u<=17:f=1;break;default:f=3}else if(p&&n>3&&n<=6)f=2;else if(p&&n>6)f=0;else if(y&&n>1&&n<=3)f=2;else if(y&&n<=1)switch(!0){case o&&u>=18&&u<=23:case u>=6&&u<=10:f=3;break;case u>=11&&u<=17:f=1;break;default:f=3}else y&&n>3&&n<=6?f=1:y&&n>6&&(f=0);if(l>3){const t=`üí® –†–µ–∑–∫–∏–π —Ä–æ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏: —Å ${r} –¥–æ ${n} –º/—Å`;v.push(t),f=f>=2?2:f}if(d>=60&&d<=300&&(n>1||r>1)&&t!==i){const t=e.degreesToCardinal(i);n>3&&n<=6?f=Math.min(f,1):n>1&&n<=3&&(f=Math.min(f,2));const r=`‚ö†Ô∏è –†–µ–∑–∫–∞—è —Å–º–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è: —Å ${t} –Ω–∞ ${m}`;v.push(r)}let b="";if(-2===h){b=`üìâ üé£ –†–µ–∑–∫–æ–µ –ø–∞–¥–µ–Ω–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è: ‚Üì ${Math.abs(h)} –º–º —Ä—Ç.—Å—Ç.\n\t\t\t\t–í–Ω–∞—á–∞–ª–µ –≤—Å–ø–ª–µ—Å–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —É –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏. ‚ö†Ô∏è –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ 3-4 —á–∞—Å–∞ —É—Ö—É–¥—à–µ–Ω–∏–µ –∫–ª–µ–≤–∞ - –º–∏–≥—Ä–∞—Ü–∏—è –∫ –±—Ä–æ–≤–∫–∞–º —Å –≥–ª—É–±–∏–Ω–æ–π 3-4 –º`,v.push(b);const t=f+1;f=t>4?4:t}else if(h<-2){b=`üìâ üé£ –†–µ–∑–∫–æ–µ –ø–∞–¥–µ–Ω–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è: ‚Üì ${Math.abs(h)} –º–º —Ä—Ç.—Å—Ç.\n\t\t\t\t\t–í–Ω–∞—á–∞–ª–µ –≤—Å–ø–ª–µ—Å–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —É –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏. ‚ö†Ô∏è –ß–µ—Ä–µ–∑ 2 —á–∞—Å–∞ - –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ä–µ–¥–Ω–∏–µ –≥–ª—É–±–∏–Ω—ã üö´ –ß–µ—Ä–µ–∑ 4 —á–∞—Å–∞ - –≤–æ–∑–º–æ–∂–µ–Ω —Å–ø–∞–¥ –∫–ª—ë–≤–∞`,v.push(b);const t=f+1;f=t>3?3:t}else h>=2&&(f=h>2?0:1,b=`üìâ üö´ –†–µ–∑–∫–∏–π —Ä–æ—Å—Ç –¥–∞–≤–ª–µ–Ω–∏—è: ‚Üë ${Math.abs(h)} –º–º —Ä—Ç.—Å—Ç.\n\t\t\t\t\t–∫–ª—ë–≤ –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç—Å—è –Ω–∞ 2-3 —á–∞—Å–∞ ‚ö†Ô∏è –ß–µ—Ä–µ–∑ 3 —á–∞—Å–∞ –≤–æ–∑–º–æ–∂–µ–Ω –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã–π –∫–ª—ë–≤ —É –¥–Ω–∞ üé£ –ß–µ—Ä–µ–∑ 6 —á–∞—Å–æ–≤ - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏`,v.push(b));let S="",C="";switch(f){case 4:S="‚úîÔ∏è",C="–æ—Ç–ª–∏—á–Ω—ã–π –∫–ª—ë–≤";break;case 3:S="‚úîÔ∏è",C="–∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª—ë–≤";break;case 2:S="",C="–≤–æ–∑–º–æ–∂–Ω—ã–π –∫–ª—ë–≤";break;case 1:S="‚ö†Ô∏è",C="–Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∫–ª—ë–≤";break;default:S="üö´",C="–Ω—É–ª–µ–≤–æ–π –∫–ª—ë–≤"}return{score:f,description:`${m} ‚Äî ${S} ${w.join(", ")} ‚Äî (${n} –º/—Å) \n\t\t${v.length>0?v.join(", "):""} ‚Äî ${C}`}}static normalizePrecipitationsData(t,e){const n=[];for(const[t,i]of e)n.push({date:t,source:"history",precipitations:i.precipitations??0,temp:i.temp.avg??null});for(const[e,i]of Object.entries(t))n.push({date:e,source:"forecast",precipitations:i.precipitations??0,temp:i.temp.avg??null});return n}static calcTempAvgCurrentTemp(t,e){const n=p.getSeason(t),i=e.find((e=>e.date===t)),r=i?i.temp:null,a=new Date(t),s=e.filter((t=>new Date(t.date)<a)).slice(-5);return s.length<5?"–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö":[r,p.round(s.reduce(((t,e)=>t+e.temp),0)/5),n]}static round(t,e=0){return parseFloat(t.toFixed(e))}}class y{constructor(){}renderMoonCurrentDay(t){this.container=document.querySelector(`[data-date="${t.date}"]`),this.moonTodayMainContainer=this.container?.querySelector(".detail-today-main-fishing__moon"),this.moonMorningMainContainer=this.container?.querySelector(".detail-morning-moon-fishing"),this.moonDayMainContainer=this.container?.querySelector(".detail-day-moon-fishing"),this.moonEveningMainContainer=this.container?.querySelector(".detail-evening-moon-fishing");const e=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div"),r=document.createElement("div");e.innerHTML=`\n\t\t<div> \n\t\t  ${t.icon||""} \n\t\t  ${t.name||""} \n\t\t  ${t.moonDay||""} –¥–µ–Ω—å –ª—É–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞\n\t\t  ${t.utroDescr.source&&t.utroDescr.source.toLowerCase()!==t.name.toLowerCase()?t.utroDescr.source:""}\n\t\t\t. ${t.utroDescr?.description?.general||""} \n\t\t</div>\n\t `,n.innerHTML=`\n\t\t<p>–í–ª–∏—è–Ω–∏–µ –ª—É–Ω—ã ${t.icon} ${t?.utroDescr?.description?.utro}</p>\n\t\t`,i.innerHTML=`\n\t\t<p>–í–ª–∏—è–Ω–∏–µ –ª—É–Ω—ã${t.icon} ${t?.utroDescr?.description?.den} </p>\n\t\t`,r.innerHTML=`\n\t\t<p>–í–ª–∏—è–Ω–∏–µ –ª—É–Ω—ã${t.icon} ${t?.utroDescr?.description?.vecher} </p>\n\t\t`,this.moonTodayMainContainer?.appendChild(e),this.moonMorningMainContainer?.appendChild(n),this.moonDayMainContainer?.appendChild(i),this.moonEveningMainContainer?.appendChild(r)}}class w{constructor(t,e){this.moonCalendar=t,this.moonTerms=e,this.moonFishingForecastRender=new y}calculate(t,e){const n=!e.includes("–Ø—Å–Ω–æ"),i=t.toISOString().split("T")[0],r=s.getLunarDay(t),a=s.getMoonPhase(t),{icon:o,name:c}=s.getMoonPhaseInfo(a),l=p.getSeason(t),d=this.moonCalendar?.[r]?.[l]||{},h=JSON.parse(JSON.stringify(d)),u=h?.utro?.term,m=this.moonTerms?.[l]?.[u]||{},g=JSON.parse(JSON.stringify(m));n&&this.applyCloudEffect(r,l,h,g.description);const y={date:i,moonDay:r,phase:a,utroDescr:g,moonDayInfo:h,icon:o,name:c},w={date:i,model:"moon",morning:h?.utro?.coefficient||0,day:h?.den?.coefficient||0,evening:h?.vecher?.coefficient||0};return this.moonFishingForecastRender.renderMoonCurrentDay(y),w}applyCloudEffect(t,e,n,i){const r=this.getCloudEffect(t,e);if(!r)return;const{target:a,operation:s,value:o,time:c,text:l}=r;(c?[c]:["utro","den","vecher"]).forEach((t=>{const e=n[t][a];"coefficient"===a?n[t][a]=Math.min(e*o,1):"modifier"===a&&("multiply"===s?n[t][a]=e<0?e/o:e*o:n[t][a]+=o),i[t]+=` ${l}`}))}getCloudEffect(t,e){switch(e){case"spring":switch(t){case 3:case 4:return{target:"modifier",operation:"multiply",value:1.2,time:"utro",text:"–û–±–ª–∞—á–Ω–æ—Å—Ç—å —É—Å–∏–ª–∏–≤–∞–µ—Ç –∫–ª–µ–≤"};case 9:case 10:return{target:"coefficient",operation:"multiply",value:1.3,time:null,text:"–û–±–ª–∞—á–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–∞–µ—Ç –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –ª—É–Ω–Ω–æ–≥–æ —Å–≤–µ—Ç–∞"};default:return null}case"summer":switch(t){case 15:case 16:return{target:"modifier",operation:"add",value:1,time:"den",text:"–û–±–ª–∞—á–Ω–æ—Å—Ç—å –ø–æ–≤—ã—à–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ª–µ—â–∞"};case 20:case 21:return{target:"modifier",operation:"multiply",value:1.4,time:"vecher",text:"–û–±–ª–∞—á–Ω–æ—Å—Ç—å —É—Å–∏–ª–∏–≤–∞–µ—Ç –∫–ª–µ–≤"};default:return null}case"autumn":switch(t){case 27:case 28:return{target:"modifier",operation:"add",value:1,time:"utro",text:"–û–±–ª–∞—á–Ω–æ—Å—Ç—å —É—Å–∏–ª–∏–≤–∞–µ—Ç –∫–ª–µ–≤"};default:return null}default:return null}}}class v{renderSeasonCurrentDay(t,e){this.container=document.querySelector(`[data-date="${t}"]`),this.mainTodayMainContainer=this.container?.querySelector(".detail-today-main-fishing__season");const n=document.createElement("div");n.innerHTML=`\n\t\t<div> \n\t\t   ${e||""}\n\t\t</div>\n\t\t`,this.mainTodayMainContainer?.appendChild(n)}}class f{constructor(){this.levelClasses={very_weak:"very_weak",weak:"weak",average:"medium",good:"good",excellent:"excellent"}}calculate(t,e){if(!Array.isArray(e)||0===e.length)return"";const n=e.find((e=>{const n=new Date(t),i=new Date(e.date_from),r=new Date(e.date_to);return n>=i&&n<=r})),i=n.bite_level||"unknown",r=`\n\t\t\t<div class="${this.levelClasses[i]||"unknown"}">\n\t\t\t  <h4>üé£ ${this.formatDateRange(n.date_from,n.date_to)}</h4>\n\t\t\t  <p><strong>${this.getLevelComment(i)}</strong></p>\n\t\t\t  <p>${n.comment||""}</p>\n\t\t\t</div>`.trim(),a={date:t,level:i};return this.seasonFishingForecastRender=new v,this.seasonFishingForecastRender.renderSeasonCurrentDay(t,r),a}formatDateRange(t,e){return`–û–±—â–∏–π –ø—Ä–æ–≥–Ω–æ–∑ –∫–ª—ë–≤–∞ —Å ${new Date(t).toLocaleDateString("ru-RU",{day:"numeric",month:"long"})} –ø–æ ${new Date(e).toLocaleDateString("ru-RU",{day:"numeric",month:"long"})}`}getLevelComment(t){switch(t){case"very_weak":return"–í —Ü–µ–ª–æ–º —Å–µ–∑–æ–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∫–ª—ë–≤–∞ –∫—Ä–∞–π–Ω–µ —Å–ª–∞–±—ã–µ.";case"weak":return"–í —Ü–µ–ª–æ–º —Å–µ–∑–æ–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∫–ª—ë–≤–∞ —Å–ª–∞–±–æ –≤—ã—Ä–∞–∂–µ–Ω—ã.";case"medium":return"–ö–ª—ë–≤ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π, –≤–æ–∑–º–æ–∂–Ω—ã –ª–æ–∫–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è.";case"good":return"–•–æ—Ä–æ—à–∏–π –ø–µ—Ä–∏–æ–¥ –¥–ª—è —Ä—ã–±–∞–ª–∫–∏, –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–ª—ë–≤–∞.";case"excellent":return"–û—Ç–ª–∏—á–Ω—ã–π –ø–µ—Ä–∏–æ–¥ ‚Äî –ª–µ—â –∞–∫—Ç–∏–≤–Ω–æ –∫–æ—Ä–º–∏—Ç—Å—è, –∫–ª—ë–≤ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–π.";default:return"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ –∫–ª—ë–≤–∞."}}}class ${constructor(){}calculate(t,e){const[n,i]=t,r=p.calculate(n),a=r.day.reduce(((t,e)=>t+e.speed),0)/r.day.length>=2,s=n.map(((t,e)=>({speed:t.speed,direction:t.direction,speedDayTrue:a,pressure:i[e]}))),o=p.calculate(s),c=this.calculateWindStats(o),l={general:null,morning:this.round(c.morning.avgScore),day:this.round(c.day.avgScore),evening:this.round(c.evening.avgScore),model:"wind"},d=this.analyzeNightWind(o.night,c.night),h=this.collectCriticalNotes(n,i,e);this.result=this.buildForecast(c,d,h,e,l)}getResult(){return this.result}getModelType(){return"wind"}collectCriticalNotes(t,e,n){const i=[];return this.detectSensitivePeriods(t,n,i),this.addTrendNotes(t,i),this.mergeBadWindNotes(i)}addTrendNotes(t,e){const n=this.buildWindNotes(t);for(const t of n)this.pushUniqueNote(t,e)}formatHour(t,e){const n=new Date(t);return n.setHours(e),n.toTimeString().slice(0,5)}buildWindNotes(t){const n=[];let i=null,r="",a=null,s="",o=!1;for(let c=0;c<t.length;c++){const{direction:l,speed:d}=t[c],h=this.getHourTime(t[c],c),u=e.degreesToCardinal(l);null!==i&&u!==r&&d>1&&this.detectSuddenChange(n,l,i,r,u,h),this.isBadDirection(u)&&d>1?a||(a=h,s=u):a&&(this.pushBadWindBlock(n,a,h,s),a=null),!o&&this.isGoodDirection(u)&&d<=3&&(n.push({time:h,comment:`‚úîÔ∏è –° ${h} –≤–µ—Ç–µ—Ä —Å–º–µ–Ω–∏–ª—Å—è –Ω–∞ ${u} –∏ –æ—Å–ª–∞–± ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª—ë–≤–∞.`}),o=!0),i=l,r=u}if(a){const e=t[t.length-1].time||`${String(t.length-1).padStart(2,"0")}:00`;this.pushBadWindBlock(n,a,e,s)}return n}getHourTime(t,e){return t.time||`${String(e).padStart(2,"0")}:00`}detectSuddenChange(t,e,n,i,r,a){const s=Math.abs(e-n);s>=60&&s<=300&&t.push({time:a,comment:`‚ö†Ô∏è –†–µ–∑–∫–∞—è —Å–º–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ—Ç—Ä–∞: —Å ${i} –Ω–∞ ${r}`})}pushBadWindBlock(t,e,n,i){e===n?t.push({time:e,comment:`üö´ –ù–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç—Ä–∞ (${i}) –º–æ–∂–µ—Ç —É—Ö—É–¥—à–∏—Ç—å –∫–ª—ë–≤`}):t.push({time:`${e}‚Äì${n}`,comment:`üö´ –° ${e} –¥–æ ${n} –ø—Ä–µ–æ–±–ª–∞–¥–∞–ª –≤–µ—Ç–µ—Ä ${i}, —á—Ç–æ –º–æ–≥–ª–æ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ –∫–ª—ë–≤.`})}isBadDirection(t){return["–° ‚Üë","–°–í ‚Üó","–í ‚Üí"].includes(t)}isGoodDirection(t){return["–Æ ‚Üì","–Æ–ó ‚Üô","–ó ‚Üê"].includes(t)}pushUniqueNote(t,e){if(!t.time||parseInt(t.time.split(":")[0])<4)return;const n=t.comment.trim().slice(0,2);if(!e.find((e=>e.time===t.time&&e.comment.trim().startsWith(n)))){const n=e.find((e=>e.time===t.time));n?n.comment.includes(t.comment)||(n.comment+=" "+t.comment):e.push(t)}}detectSensitivePeriods(t,e,n){for(let i=0;i<t.length-2;i++){const r=t[i],a=t[i+1],s=t[i+2],o=Math.abs(s.direction-r.direction),c=s.speed-r.speed,l=i+2;if((l>=4&&l<=8||l>=18&&l<=22)&&(o>45||c>2)&&(r.speed>2||a.speed>2||s.speed>2)){const t=this.formatHour(e,l);this.pushUniqueNote({time:t,comment:"üåÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤–µ—Ç—Ä–∞ –≤ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥ (—É—Ç—Ä–æ/–≤–µ—á–µ—Ä)"},n)}}}calculateWindStats(t={}){return{night:this.getWindStats(t.night||[],"night"),morning:this.getWindStats(t.morning||[],"morning"),day:this.getWindStats(t.day||[],"day"),evening:this.getWindStats(t.evening||[],"evening")}}analyzeNightWind(t,n){let i="";for(const{direction:e,speed:n}of t){if(e>=60&&e<=100&&n>=2){i="üìç –ù–æ—á—å—é –≤–µ—Ç–µ—Ä –¥—É–ª —Å –≤–æ—Å—Ç–æ–∫–∞ –≤ —Å—Ç–æ—Ä–æ–Ω—É –ª–µ–≤–æ–≥–æ –±–µ—Ä–µ–≥–∞. üé£ –í–æ–∑–º–æ–∂–Ω–æ —Å–∫–æ–ø–ª–µ–Ω–∏–µ —Ä—ã–±—ã —É –ª–µ–≤–æ–≥–æ –±–µ—Ä–µ–≥–∞ —É—Ç—Ä–æ–º.</br>";break}if(e>=240&&e<=280&&n>=2){i="üìç –ù–æ—á—å—é –≤–µ—Ç–µ—Ä –¥—É–ª —Å –∑–∞–ø–∞–¥–∞ –≤ —Å—Ç–æ—Ä–æ–Ω—É –ø—Ä–∞–≤–æ–≥–æ –±–µ—Ä–µ–≥–∞. üé£ –£—Ç—Ä–æ–º —Å—Ç–æ–∏—Ç –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ª–æ–≤–ª—é —É –ø—Ä–∞–≤–æ–≥–æ –±–µ—Ä–µ–≥–∞.</br>";break}}const r=t.slice(-3).map((t=>({dir:e.degreesToCardinal(t.direction),speed:t.speed})));return r.some((t=>"–í ‚Üí"===t.dir))&&r[2].speed<r[0].speed&&(i+=" ‚ö†Ô∏è –í–æ—Å—Ç–æ—á–Ω—ã–π –≤–µ—Ç–µ—Ä –æ—Å–ª–∞–± –∫ —É—Ç—Ä—É, —ç—Ç–æ –º–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å –∫–ª—ë–≤. ‚úîÔ∏è"),i}buildForecast(t,e,n,i,r){const a=this.buildHourlyDetails(t);let s=n.length?n.reduce(((t,e)=>t+e.time+" - "+e.comment+"\n"),""):null;return"string"==typeof s&&(s=[...new Set(s.split("\n"))].join("<br>")),{date:i,details:{morning:[this.describeWindEffect(t.morning,"üí® –í–ª–∏—è–Ω–∏–µ –≤–µ—Ç—Ä–∞"),...a.morning],day:[this.describeWindEffect(t.day,"üí® –í–ª–∏—è–Ω–∏–µ –≤–µ—Ç—Ä–∞"),...a.day],evening:[this.describeWindEffect(t.evening,"üí® –í–ª–∏—è–Ω–∏–µ –≤–µ—Ç—Ä–∞"),...a.evening]},weights:r,general:[this.buildGeneralNote(t,e),s,this.buildSummary(t)].filter(Boolean)}}buildGeneralNote(t,e){let n=`üí® –í–µ—Ç—Ä–æ–≤—ã–µ —É—Å–ª–æ–≤–∏—è –∑–∞ —Å—É—Ç–∫–∏:</br>‚Ä¢ üåÖ –£—Ç—Ä–æ: ${t.morning.avgSpeed} –º/—Å (${t.morning.commonDirection})</br>‚Ä¢ ‚òÄÔ∏è –î–µ–Ω—å: ${t.day.avgSpeed} –º/—Å (${t.day.commonDirection})</br>‚Ä¢ üåá –í–µ—á–µ—Ä: ${t.evening.avgSpeed} –º/—Å (${t.evening.commonDirection})</br>`;return e&&(n+=`\n${e}`),n}buildSummary(t){const e=(t.morning.avgScore+t.day.avgScore+t.evening.avgScore)/3,n=["morning","day","evening"].reduce(((e,n)=>t[e].avgScore>t[n].avgScore?e:n));let i="";return i=e>=3.5?"<b>‚úîÔ∏è –û—Ç–ª–∏—á–Ω—ã–µ –≤–µ—Ç—Ä–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –¥–ª—è –ª–æ–≤–ª–∏ –ª–µ—â–∞!</b>\n":e>=2.5?`<b>‚úîÔ∏è –•–æ—Ä–æ—à–∏–µ –≤–µ—Ç—Ä–æ–≤—ã–µ —É—Å–ª–æ–≤–∏—è. –õ—É—á—à–∏–π –ø–µ—Ä–∏–æ–¥ - ${this.translatePeriod(n)}</b>\n`:e>=2?"<b>‚ö†Ô∏è –£–º–µ—Ä–µ–Ω–Ω—ã–π –∫–ª—ë–≤, –≤—ã–±–∏—Ä–∞–π—Ç–µ –º–æ–º–µ–Ω—Ç—ã —Å —Ö–æ—Ä–æ—à–∏–º –≤–µ—Ç—Ä–æ–º</b>\n":e>=1.5?"<b>‚ö†Ô∏è –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∫–ª—ë–≤, –≤—ã–±–∏—Ä–∞–π—Ç–µ –º–æ–º–µ–Ω—Ç—ã —Å —Ö–æ—Ä–æ—à–∏–º –≤–µ—Ç—Ä–æ–º</b>\n":"üî¥ –ù–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã–µ –≤–µ—Ç—Ä–æ–≤—ã–µ —É—Å–ª–æ–≤–∏—è\n",i}buildHourlyDetails(t){const e={night:t.night.evaluations.map((t=>t.description)),morning:t.morning.evaluations.map((t=>t.description)),day:t.day.evaluations.map((t=>t.description)),evening:t.evening.evaluations.map((t=>t.description))};return this.groupPeriodDetails(e)}translatePeriod(t){return{morning:"—É—Ç—Ä–æ",day:"–¥–µ–Ω—å",evening:"–≤–µ—á–µ—Ä"}[t]}getWindStats(t,e){if(!t||0===t.length)return this.createEmptyStats();const n=t.map(((n,i)=>({...n,time:n.time||p.generateTimeForPeriod(i,t.length,e)}))),i=n.map(((t,e)=>{const i=n[e-1],r=n[e-2];return{time:t.time,evaluation:p.evaluateBreamWind(t.direction,t.speed,i?.direction,i?.speed,t.pressure,r?.pressure,t.speedDayTrue,t.time)}}));return{avgSpeed:p.calculateAvgSpeed(n),commonDirection:p.getDominantDirection(i.map((t=>t.evaluation))),avgScore:i.reduce(((t,{evaluation:e})=>t+e.score),0)/i.length,evaluations:i.map((t=>t.evaluation)),bestHour:{time:p.formatTimeBasic(p.findBestTimeEntry(i).time),evaluation:p.findBestTimeEntry(i).evaluation}}}createEmptyStats(){return{avgSpeed:"0.0",commonDirection:"–ù/–î",avgScore:0,evaluations:[],bestHour:{time:"--:--",evaluation:{score:0,description:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"}}}}describeWindEffect(t,e){const n=t.avgScore;let i,r,a;n>=3.5?(i="‚úîÔ∏è",r="–û—Ç–ª–∏—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è",a="–ò–¥–µ–∞–ª—å–Ω—ã–µ –≤–µ—Ç—Ä–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –¥–ª—è –ª–æ–≤–ª–∏ –ª–µ—â–∞!"):n>=2.5?(i="üé£",r="–•–æ—Ä–æ—à–∏–µ —É—Å–ª–æ–≤–∏—è",a="–ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è —Ä—ã–±–∞–ª–∫–∏"):n>=1.5?(i="",r="–°—Ä–µ–¥–Ω–∏–µ —É—Å–ª–æ–≤–∏—è",a="–ö–ª—ë–≤ –≤–æ–∑–º–æ–∂–µ–Ω, –Ω–æ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω"):n>=1?(i="‚ö†Ô∏è",r="–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∫–ª–µ–≤",a="–ö–ª—ë–≤ –≤–æ–∑–º–æ–∂–µ–Ω, –Ω–æ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω"):(i="üö´",r="–ü–ª–æ—Ö–∏–µ —É—Å–ª–æ–≤–∏—è",a="–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–µ –≤—Ä–µ–º—è");let s=`${i} ${e}: ${r}. ${a}\n<br>‚ñ∏ –°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å: ${t.avgSpeed} –º/—Å - ${this.getSpeedDescription(t.avgSpeed)}<br>‚ñ∏ –ü—Ä–µ–æ–±–ª–∞–¥–∞—é—â–µ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: ${t.commonDirection} ${this.getDirectionDescription(t.commonDirection)}<br>`;if(t.bestHour&&"--:--"!==t.bestHour.time){const[e,...n]=t.bestHour.evaluation.description.split(" ‚Äî ");s+=`\n‚ñ∏ –õ—É—á—à–µ–µ –≤—Ä–µ–º—è: ${t.bestHour.time} (${e} ${n.join(" ")})<br>`}return s}getSpeedDescription(t){const e=parseFloat(t);return e<=1?"—à—Ç–∏–ª—å":e<=3?"–æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –¥–ª—è –∫–ª–µ–≤–∞":e<=6?"—É–º–µ—Ä–µ–Ω–Ω–∞—è":"—Å–∏–ª—å–Ω—ã–π –≤–µ—Ç–µ—Ä"}getDirectionDescription(t){return["–Æ ‚Üì","–Æ–ó ‚Üô","–ó ‚Üê"].includes(t)?"–ë–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ":["–°–ó ‚Üñ","–Æ–í ‚Üò"].includes(t)?"–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ":"–ù–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"}mergeBadWindNotes(t){const e=[];let n=null,i=null,r=null;for(let a=0;a<t.length;a++){const s=t[a];if(s.processed)continue;if(!s.comment.startsWith("üö´")){e.push(s);continue}const o=s.comment.match(/\((.+?)\)/),c=o?o[1]:null;if(n){const t=parseInt(i.split(":")[0]);parseInt(s.time.split(":")[0])===t+1&&c===r?(i=s.time,s.processed=!0):(this.pushBlockNote(e,n,i,r),n=s.time,i=s.time,r=c,s.processed=!0)}else n=s.time,i=s.time,r=c,s.processed=!0}return n&&i&&this.pushBlockNote(e,n,i,r),t.filter((t=>!t.processed)).forEach((t=>e.push(t))),e}pushBlockNote(t,e,n,i){t.some((t=>t.time===`${e}‚Äì${n}`&&t.comment.includes(i||"–ù–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç—Ä–∞")))||(e===n?t.push({time:e,comment:i?`‚ö†Ô∏è –ù–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç—Ä–∞ (${i}) –º–æ–∂–µ—Ç —É—Ö—É–¥—à–∏—Ç—å –∫–ª—ë–≤</br>`:"‚ö†Ô∏è –ù–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç—Ä–∞ –º–æ–∂–µ—Ç —É—Ö—É–¥—à–∏—Ç—å –∫–ª—ë–≤</br>"}):t.push({time:`${e}‚Äì${n}`,comment:i?`‚ö†Ô∏è –° ${e} –¥–æ ${n} –ø—Ä–µ–æ–±–ª–∞–¥–∞–ª –≤–µ—Ç–µ—Ä ${i}, —á—Ç–æ –º–æ–≥–ª–æ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ –∫–ª—ë–≤.</br>`:`‚ö†Ô∏è –° ${e} –¥–æ ${n} –ø—Ä–µ–æ–±–ª–∞–¥–∞–ª –Ω–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã–π –≤–µ—Ç–µ—Ä, —á—Ç–æ –º–æ–≥–ª–æ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ –∫–ª—ë–≤.</br>`}))}groupPeriodDetails(t){const e={};for(const[n,i]of Object.entries(t)){if(!i||0===i.length)continue;const t=[];let r={text:i[0],start:0,end:0};for(let e=1;e<i.length;e++)i[e]===r.text?r.end=e:(t.push({...r}),r={text:i[e],start:e,end:e});t.push({...r}),e[n]=t.map((({start:t,end:e,text:r})=>`${p.generateTimeForPeriod(t,i.length,n)} ‚Äì ${p.generateTimeForPeriod(e+1,i.length,n)} ${r}`))}return e}round(t,e=0){return parseFloat(t.toFixed(e))}}class D{constructor(t,e,n){this.season=t,this.t5=e,this.t1=n,this.seasonZones={spring:{min:4,optLow:7,optHigh:14,max:17},summer:{min:15,optLow:16,optHigh:22,max:26},autumn:{min:8,optLow:10,optHigh:17,max:20},winter:{min:-15,optLow:-3,optHigh:2,max:4}},this.timeAdjust={spring:{morning:1,day:0,evening:1},summer:{morning:2,day:-1,evening:1},autumn:{morning:1,day:1,evening:1},winter:{morning:0,day:-1,evening:0}}}getTemperatureScore(){const t=this.seasonZones[this.season];if(!t)return 0;const e=this.t5,n=this.t1,i=e=>e>=t.optLow&&e<=t.optHigh,r=e=>e>=t.min&&e<t.optLow||e>t.optHigh&&e<=t.max,a=i(e)?"opt":r(e)?"border":"bad",s=i(n)?"opt":r(n)?"border":"bad";return"opt"===a&&"opt"===s?2:"opt"===a&&"border"===s||"border"===a&&"opt"===s?1:"border"===a&&"border"===s?0:-1}getScoreByPeriod(t){let e=this.getTemperatureScore()+(this.timeAdjust[this.season]?.[t]??0);return Math.max(-1,Math.min(2,e))}getForecast(){return{morning:this.getScoreByPeriod("morning"),day:this.getScoreByPeriod("day"),evening:this.getScoreByPeriod("evening")}}}class b{constructor(){}calculate(t,e){const n=p.getSeason(e),i=t.find((t=>t.date===e)),r=i?i.temp:null,a=new Date(e),s=t.filter((t=>new Date(t.date)<a)).slice(-5);if(s.length<5)return"–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö";const o=this.round(s.reduce(((t,e)=>t+e.precipitations),0),1),c=this.round(s.reduce(((t,e)=>t+e.temp),0)/5);let l=0,d="";if(r){const t=Math.abs(r-c);t>5&&(l=-1,d=` ‚ö†Ô∏è –†–µ–∑–∫–∏–π –ø–µ—Ä–µ–ø–∞–¥ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (${t}¬∞C)`),t>10&&(l=-2,d=` üö´ –û–ø–∞—Å–Ω—ã–π –ø–µ—Ä–µ–ø–∞–¥ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (${t}¬∞C)`)}let h=0,u="";"summer"===n||"spring"===n?o>30&&"summer"===n?(h=-2,u="üö´ –ü—Ä–µ–∫—Ä–∞—â–µ–Ω–∏–µ –∫–ª–µ–≤–∞. –°–∏–ª—å–Ω—ã–π —Å–º—ã–≤ –≥—Ä—É–Ω—Ç–∞ –∏ –æ—Ä–≥–∞–Ω–∏–∫–∏, –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º—É—Ç–∏ –Ω–∞ —Ç–µ—á–µ–Ω–∏–∏. –õ–µ—â —É—Ö–æ–¥–∏—Ç –≤ –≥–ª—É–±–∏–Ω–Ω—ã–µ —è–º—ã (7+ –º) –∏ –ø–µ—Ä–µ—Å—Ç–∞–µ—Ç –∫–æ—Ä–º–∏—Ç—å—Å—è 2-3 –¥–Ω—è."):o>40&&"spring"===n?(h=-2,u="üö´ –ü–∞–≤–æ–¥–∫–æ–≤—ã–π —Å–±—Ä–æ—Å - –ª–µ—â –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –Ω–µ—Ä–µ—Å—Ç–∏–ª–∏—â–∞—Ö, –∫–ª—ë–≤ –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç—Å—è"):o>15?c>=16&&c<=22?(h=2,u="‚úîÔ∏è –ö–ª—ë–≤ –∞–∫—Ç–∏–≤–Ω—ã–π. –û–±–∏–ª—å–Ω—ã–µ –¥–æ–∂–¥–∏ –ø—Ä–∏–≤–µ–ª–∏ –∫ —Å–±—Ä–æ—Å—É –≤–æ–¥—ã —Å –≤–æ–¥–æ—Ö—Ä–∞–Ω–∏–ª–∏—â–∞, —É—Å–∏–ª–∏–ª–æ—Å—å —Ç–µ—á–µ–Ω–∏–µ. –ü—Ä–∏–∫–æ—Ä–º–∫–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è, –∫–∏—Å–ª–æ—Ä–æ–¥ –≤ –≤–æ–¥–µ –ø–æ–≤—ã—à–∞–µ—Ç—Å—è, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ ‚Äî –ª–µ—â –∞–∫—Ç–∏–≤–Ω–æ –∫–æ—Ä–º–∏—Ç—Å—è"):(h=1,u=`–û—Å–∞–¥–∫–æ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –Ω–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–æ–∑–¥—É—Ö–∞ ${c}¬∞C –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞. –í–æ–∑–º–æ–∂–Ω—ã –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —É—Ö—É–¥—à–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ä—ã–±—ã.`):o>5?c>=16&&c<=22?(h=1,u="üëç –£–º–µ—Ä–µ–Ω–Ω—ã–µ –¥–æ–∂–¥–∏ —Å–ø–æ—Å–æ–±—Å—Ç–≤—É—é—Ç –º—è–≥–∫–æ–º—É —Å–±—Ä–æ—Å—É –≤–æ–¥—ã, —Ç–µ—á–µ–Ω–∏–µ —É–º–µ—Ä–µ–Ω–Ω–æ–µ. –≠—Ç–æ —É—Å–∏–ª–∏–≤–∞–µ—Ç –ø–æ–¥–≤–∏–∂–Ω–æ—Å—Ç—å –ª–µ—â–∞, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ."):(h=0,u=`‚ûñ –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ: –û—Å–∞–¥–∫–∏ –µ—Å—Ç—å, –Ω–æ —Å—Ä–µ–¥–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ ${c}¬∞C –Ω–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞ –¥–ª—è –º–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ª–µ—â–∞.`):(h=-1,u="‚ö†Ô∏è –ö–ª—ë–≤ –æ—Å–ª–∞–±–µ–≤–∞–µ—Ç. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ–∂–¥–µ–π –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Å–Ω–∏–∂–µ–Ω–∏—é —É—Ä–æ–≤–Ω—è –≤–æ–¥—ã, —Ç–µ—á–µ–Ω–∏–µ —Å–ª–∞–±–æ–µ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç. –í –∂–∞—Ä–∫—É—é –ø–æ–≥–æ–¥—É –≤–æ–¥–∞ –±–µ–¥–Ω–µ–µ—Ç –∫–∏—Å–ª–æ—Ä–æ–¥–æ–º, —Ä—ã–±–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤—è–ª–æ–π –∏ –æ—Ç—Ö–æ–¥–∏—Ç –≤ –≥–ª—É–±–∏–Ω—É."):"autumn"===n?c>=8&&c<=14?(h=Math.max(h,2),u="‚úîÔ∏è –ü—Ä–µ–¥–∑–∏–º–Ω–∏–π –∂–æ—Ä! –õ–µ—â –∞–∫—Ç–∏–≤–Ω–æ –ø–∏—Ç–∞–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –æ—Å–∞–¥–∫–æ–≤"):c>14&&c<=20?o>40?(h=-2,u="üö´ –ß—Ä–µ–∑–º–µ—Ä–Ω—ã–µ –æ—Å–∞–¥–∫–∏ (40+ –º–º). –í–æ–¥–∞ —Å–∏–ª—å–Ω–æ –º—É—Ç–Ω–∞—è, –≤–æ–∑–º–æ–∂–Ω—ã —Å–±—Ä–æ—Å—ã ‚Äî –∫–ª—ë–≤ —Å—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π."):o>30?(h=-1.5,u="‚ö†Ô∏è –û—Å–∞–¥–∫–æ–≤ –º–Ω–æ–≥–æ (30‚Äì50 –º–º). –í–æ–¥–∞ –º—É—Ç–Ω–∞—è, —Ç–µ—á–µ–Ω–∏–µ —Ä–µ–∑–∫–æ–µ, –∫–ª—ë–≤ –æ—Å–ª–∞–±–ª–µ–Ω."):o>5?(h=1,u="üëç –£–º–µ—Ä–µ–Ω–Ω—ã–µ –æ—Å–∞–¥–∫–∏ –∏ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ ‚Äî –∫–ª—ë–≤ —É—Å—Ç–æ–π—á–∏–≤—ã–π."):(h=0,u="‚ö†Ô∏è –û—Å–∞–¥–∫–æ–≤ –º–∞–ª–æ, —Ç–µ—á–µ–Ω–∏–µ —Å–ª–∞–±–æ–µ. –ö–ª—ë–≤ —Å—Ä–µ–¥–Ω–∏–π –∏–ª–∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π."):(h=-1,u=`‚ö†Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ ${c}¬∞C –∏ –æ—Å–∞–¥–∫–∏ ${o} –º–º –Ω–µ —Å–æ–∑–¥–∞—é—Ç –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π.`):(h=0,u=null),-2===h&&-2===l?h=-2:(h+=.5*l,h=Math.max(Math.min(h,2),-2));const m=`üíß –û—Å–∞–¥–∫–∏ –∑–∞ 5 –¥–Ω–µ–π: ${o} –º–º <br>–°—Ä–µ–¥–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∑–∞ 5 –¥–Ω–µ–π: ${c}¬∞C <br>üé£ –í–ª–∏—è–Ω–∏–µ –æ—Å–∞–¥–∫–æ–≤ –∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã: ${u} ${d}<br>`;this.result={date:e,details:{morning:[],day:[],evening:[]},weights:{general:h,model:"precipitations"},general:m}}getResult(){return this.result}round(t,e=0){return parseFloat(t.toFixed(e))}getModelType(){return"precipitations"}}class S{constructor(){this.result={}}calculate(e,n){const i=p.getSeason(n),r=p.calculate(e),a={morning:[],day:[],evening:[]},s=[],o=[],c=[];this.impactsWeights=[];for(const[n,l]of Object.entries(r))if("night"!==n&&a[n])for(const r of l){const l=r.time?.slice(11,16)||"00:00",d=t.getWeatherType(r),h=t.getWeatherDescription(r),u=this.getImpact(d,i,n,e);if(u?this.impactsWeights.push(u.weight):this.impactsWeights.push(0),!u)continue;const m=`${l} ${u.emoji} ${h} ‚Äî ${u.comment}`;a[n].push(m),c.push({type:u.type,weight:u.weight,comment:u.comment}),u.weight>0?s.push(u.weight):u.weight<0&&o.push(u.weight)}for(const t in a)a[t]=this.groupConsecutiveNotes(a[t]);const l=this.getGeneralConclusion(s,o,i,c);this.result={general:l,details:a,date:n,weights:this.getWeightsObject()}}getWeightsObject(){const t=this.impactsWeights||[],e=t.slice(0,t.length/3),n=t.slice(t.length/3,2*t.length/3),i=t.slice(2*t.length/3),r=t=>t.length?t.reduce(((t,e)=>t+e),0)/t.length:0;return{general:this.round(r(t)),morning:this.round(r(e)),day:this.round(r(n)),evening:this.round(r(i)),model:this.getModelType()}}round(t,e=1){return parseFloat(t.toFixed(e))}getModelType(){throw new Error("–ú–µ—Ç–æ–¥ getModelType –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ –Ω–∞—Å–ª–µ–¥—É–µ–º–æ–º –∫–ª–∞—Å—Å–µ")}groupConsecutiveNotes(t){if(!t.length)return[];const e=[];let n=null;for(const i of t){const t=i.match(/^(\d{2}:\d{2}) (.+?) ‚Äî (.+)$/);if(!t)continue;const[r,a,s,o]=t;n&&n.weatherType===s&&n.comment===o?n.endTime=a:(n&&e.push(this.formatNote(n)),n={startTime:a,endTime:a,weatherType:s,comment:o})}return n&&e.push(this.formatNote(n)),e}formatNote({startTime:t,endTime:e,weatherType:n,comment:i}){return`${t===e?t:`${t} ‚Äì ${e}`} ${n} ‚Äî ${i}`}getGeneralConclusion(t,e,n,i=[]){if(!i.length)return"";const r=this.groupImpactsByType(i),a=[];for(const[t,e]of Object.entries(r)){const n=this.getIconForType(t),i=[...new Set(e.map((t=>t.comment)))].map((t=>`‚Äî ${t}`));a.push(`${n} ${t}:</br>${i.join("</br>")}`)}let s="";const o=t.reduce(((t,e)=>t+e),0),c=e.reduce(((t,e)=>t+e),0);return s=o>Math.abs(c)?this.getSeasonPositivePhrase(n):Math.abs(c)>o?this.getSeasonNegativePhrase(n):this.getMixedImpactPhrase(n),a.length>0?[...a,`üìä –í —Ü–µ–ª–æ–º: ${s}`].join("\n\n"):""}getPositivePhrase(t){return"–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–∞ –¥–ª—è –∫–ª—ë–≤–∞"}getNegativePhrase(t){return"—Å–Ω–∏–∂–∞–µ—Ç –∫–ª—ë–≤"}getNeutralPhrase(t){return"–Ω–µ –æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–º–µ—Ç–Ω–æ–≥–æ –≤–ª–∏—è–Ω–∏—è"}getSeasonPositivePhrase(t){return"–£—Å–ª–æ–≤–∏—è —Å–ø–æ—Å–æ–±—Å—Ç–≤—É—é—Ç –∞–∫—Ç–∏–≤–Ω–æ–º—É –∫–ª—ë–≤—É –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è"}getSeasonNegativePhrase(t){return"–û–±—â–∏–µ –ø–æ–≥–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —Å–Ω–∏–∂–∞—é—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä—ã–±—ã"}getMixedImpactPhrase(t){return"–ü–æ–≥–æ–¥–∞ –ø–µ—Ä–µ–º–µ–Ω—á–∏–≤–∞ ‚Äî –≤–æ–∑–º–æ–∂–Ω—ã –ø–µ—Ä–∏–æ–¥—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –∑–∞—Ç–∏—à—å—è"}getIconForType(t){return{–Ø—Å–Ω–æ:"‚òÄÔ∏è","–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —è—Å–Ω–æ":"‚òÄÔ∏è","–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å":"‚õÖ",–û–±–ª–∞—á–Ω–æ:"‚òÅÔ∏è",–ü–∞—Å–º—É—Ä–Ω–æ:"‚òÅÔ∏è",–¢—É–º–∞–Ω:" üåÅ",–ú–æ—Ä–æ—Å—å:"‚òî","–ú–æ—Ä–æ—Å—å: —Å–ª–∞–±–∞—è":"‚òî","–ú–æ—Ä–æ—Å—å: —É–º–µ—Ä–µ–Ω–Ω–∞—è":"‚òî","–ú–æ—Ä–æ—Å—å: —Å–∏–ª—å–Ω–∞—è":"‚òî","–õ–µ–¥—è–Ω–∞—è –º–æ—Ä–æ—Å—å: —Å–ª–∞–±–∞—è":"‚ùÑÔ∏è","–õ–µ–¥—è–Ω–∞—è –º–æ—Ä–æ—Å—å: —Å–∏–ª—å–Ω–∞—è":"‚ùÑÔ∏è","–î–æ–∂–¥—å: —Å–ª–∞–±—ã–π":"‚õàÔ∏è","–î–æ–∂–¥—å: —É–º–µ—Ä–µ–Ω–Ω—ã–π":"‚õàÔ∏è","–î–æ–∂–¥—å: —Å–∏–ª—å–Ω—ã–π":"‚õàÔ∏è","–õ–µ–¥—è–Ω–æ–π –¥–æ–∂–¥—å: —Å–ª–∞–±—ã–π":"‚ùÑÔ∏è","–õ–µ–¥—è–Ω–æ–π –¥–æ–∂–¥—å: —Å–∏–ª—å–Ω—ã–π":"‚ùÑÔ∏è","–°–Ω–µ–≥: —Å–ª–∞–±—ã–π":"‚ùÑÔ∏è","–°–Ω–µ–≥: —É–º–µ—Ä–µ–Ω–Ω—ã–π":"‚ùÑÔ∏è","–°–Ω–µ–≥: —Å–∏–ª—å–Ω—ã–π":"‚ùÑÔ∏è","–°–Ω–µ–∂–Ω—ã–µ –∑–µ—Ä–Ω–∞":"‚ùÑÔ∏è","–°–Ω–µ–≥–æ–ø–∞–¥: —Å–ª–∞–±—ã–π":"‚ùÑÔ∏è","–°–Ω–µ–≥–æ–ø–∞–¥: —Å–∏–ª—å–Ω—ã–π":"‚ùÑÔ∏è","–õ–∏–≤–µ–Ω—å: —Å–ª–∞–±—ã–π":"‚õàÔ∏è","–õ–∏–≤–µ–Ω—å: —É–º–µ—Ä–µ–Ω–Ω—ã–π":"‚õàÔ∏è","–õ–∏–≤–µ–Ω—å: —Å–∏–ª—å–Ω—ã–π":"‚õàÔ∏è","–ì—Ä–æ–∑–∞: —Å–ª–∞–±–∞—è":"‚õàÔ∏è","–ì—Ä–æ–∑–∞ —Å –≥—Ä–∞–¥–æ–º: —Å–ª–∞–±–∞—è":"‚õàÔ∏è"}[t]||""}getImpact(t,e,n,i){throw new Error("–ú–µ—Ç–æ–¥ getImpact –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ –Ω–∞—Å–ª–µ–¥—É–µ–º–æ–º –∫–ª–∞—Å—Å–µ")}groupImpactsByType(t){const e={};for(const n of t)e[n.type]||(e[n.type]=[]),e[n.type].push(n);return e}getResult(){return this.result}}class C extends S{getImpact(t,e,n){const i=["–Ø—Å–Ω–æ","–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —è—Å–Ω–æ","–Ø—Å–Ω–∞—è –ø–æ–≥–æ–¥–∞"].includes(t),r=["–û–±–ª–∞—á–Ω–æ","–ü–∞—Å–º—É—Ä–Ω–æ","–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –æ–±–ª–∞—á–Ω–æ","–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å"].includes(t);if("summer"===e){if("morning"===n){if(i)return{type:"–Ø—Å–Ω–∞—è –ø–æ–≥–æ–¥–∞",weight:1,comment:"‚úîÔ∏è –£—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ–ª–Ω—Ü–µ - —Ö–æ—Ä–æ—à–∏–π –∫–ª—ë–≤ –¥–æ –Ω–∞—Å—Ç—É–ø–ª–µ–Ω–∏—è –∂–∞—Ä—ã<br>",emoji:"üåÖ"};if("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å"===t)return{type:"–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å",weight:2,comment:"‚úîÔ∏è –ò–¥–µ–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è —É—Ç—Ä–µ–Ω–Ω–µ–π –ª–æ–≤–ª–∏<br>",emoji:"‚õÖ"}}if("day"===n){if(i)return{type:"–Ø—Å–Ω–∞—è –ø–æ–≥–æ–¥–∞",weight:-2,comment:"‚ö†Ô∏è –°–∏–ª—å–Ω–∞—è –∂–∞—Ä–∞ - –∫–ª—ë–≤ —Ç–æ–ª—å–∫–æ –Ω–∞ –≥–ª—É–±–∏–Ω–µ<br>",emoji:"üî•"};if("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å"===t)return{type:"–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å",weight:1,comment:"‚úîÔ∏è –û–±–ª–∞—á–Ω–æ—Å—Ç—å —Å–º—è–≥—á–∞–µ—Ç –∂–∞—Ä—É - —Ä—ã–±–∞ –∞–∫—Ç–∏–≤–Ω–∞<br>",emoji:"‚õÖ"};if("–ü–∞—Å–º—É—Ä–Ω–æ"===t)return{type:"–ü–∞—Å–º—É—Ä–Ω–æ",weight:2,comment:"‚úîÔ∏è –õ—É—á—à–∏–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –¥–Ω–µ–≤–Ω–æ–π –ª–æ–≤–ª–∏ –ª–µ—Ç–æ–º<br>",emoji:"‚òÅÔ∏è"}}if("evening"===n){if(r)return{type:"–û–±–ª–∞—á–Ω–∞—è –ø–æ–≥–æ–¥–∞",weight:2,comment:"‚úîÔ∏è –ü–∞—Å–º—É—Ä–Ω—ã–π –≤–µ—á–µ—Ä - –ø–∏–∫ –∫–ª—ë–≤–∞<br>",emoji:"üåÜ"};if("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å"===t)return{type:"–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å",weight:1,comment:"‚úîÔ∏è –•–æ—Ä–æ—à–∏–µ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã –¥–ª—è –≤–µ—á–µ—Ä–Ω–µ–π —Ä—ã–±–∞–ª–∫–∏<br>",emoji:"‚õÖ"}}}if("spring"===e){if("morning"===n){if(i)return{type:"–Ø—Å–Ω–∞—è –ø–æ–≥–æ–¥–∞",weight:2,comment:"‚úîÔ∏è –°–æ–ª–Ω–µ—á–Ω–æ–µ —É—Ç—Ä–æ - –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª—ë–≤ –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Ç—ã—Ö —É—á–∞—Å—Ç–∫–∞—Ö<br>",emoji:"‚òÄÔ∏è"};if("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å"===t)return{type:"–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å",weight:1,comment:"‚úîÔ∏è –£–º–µ—Ä–µ–Ω–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä—ã–±—ã<br>",emoji:"‚õÖ"}}if("day"===n){if(r)return{type:"–û–±–ª–∞—á–Ω–∞—è –ø–æ–≥–æ–¥–∞",weight:-1,comment:"‚ûñ –•–æ–ª–æ–¥–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å –∑–∞–º–µ–¥–ª—è–µ—Ç –ø—Ä–æ–≥—Ä–µ–≤ –≤–æ–¥—ã<br>",emoji:"‚òÅÔ∏è"};if("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å"===t)return{type:"–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å",weight:1,comment:"‚úîÔ∏è –ë–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –ª–æ–≤–ª–∏<br>",emoji:"‚õÖ"}}if("evening"===n){if("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å"===t)return{type:"–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å",weight:2,comment:"‚úîÔ∏è –ò–¥–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –≤–µ—Å–µ–Ω–Ω–µ–π —Ä—ã–±–∞–ª–∫–∏<br>",emoji:"üåá"};if(i)return{type:"–Ø—Å–Ω–∞—è –ø–æ–≥–æ–¥–∞",weight:1,comment:"‚úîÔ∏è –¢—ë–ø–ª—ã–π –≤–µ—á–µ—Ä - —Ö–æ—Ä–æ—à–∏–π –∫–ª—ë–≤<br>",emoji:"‚òÄÔ∏è"}}}if("autumn"===e){if(r){if("morning"===n)return{type:"–û–±–ª–∞—á–Ω–∞—è –ø–æ–≥–æ–¥–∞",weight:2,comment:"‚úîÔ∏è –ü–∞—Å–º—É—Ä–Ω–æ–µ —É—Ç—Ä–æ - –ª—É—á—à–∏–π –∫–ª—ë–≤ –æ—Å–µ–Ω—å—é<br>",emoji:"‚òÅÔ∏è"};if("day"===n)return{type:"–û–±–ª–∞—á–Ω–∞—è –ø–æ–≥–æ–¥–∞",weight:2,comment:"‚úîÔ∏è –û–±–ª–∞—á–Ω—ã–π –¥–µ–Ω—å - —Ä—ã–±–∞ –∞–∫—Ç–∏–≤–Ω–æ –ø–∏—Ç–∞–µ—Ç—Å—è<br>",emoji:"‚òÅÔ∏è"};if("evening"===n)return{type:"–û–±–ª–∞—á–Ω–∞—è –ø–æ–≥–æ–¥–∞",weight:1,comment:"‚úîÔ∏è –•–æ—Ä–æ—à–∏–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –≤–µ—á–µ—Ä–Ω–µ–π –ª–æ–≤–ª–∏<br>",emoji:"‚òÅÔ∏è"}}if("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å"===t&&"day"!==n)return{type:"–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å",weight:1,comment:"‚úîÔ∏è –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è –ø–æ–≥–æ–¥–∞ - —Å—Ä–µ–¥–Ω–∏–π –∫–ª—ë–≤<br>",emoji:"‚õÖ"}}if("winter"===e){if(r)return"day"===n?{type:"–û–±–ª–∞—á–Ω–∞—è –ø–æ–≥–æ–¥–∞",weight:2,comment:"‚úîÔ∏è –ü–∞—Å–º—É—Ä–Ω—ã–π –¥–µ–Ω—å - –ª—É—á—à–∏–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –∑–∏–º–Ω–µ–π –ª–æ–≤–ª–∏<br>",emoji:"‚òÅÔ∏è"}:{type:"–û–±–ª–∞—á–Ω–∞—è –ø–æ–≥–æ–¥–∞",weight:1,comment:"‚úîÔ∏è –û–±–ª–∞—á–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∫–ª—ë–≤<br>",emoji:"‚òÅÔ∏è"};if(i)return"day"===n?{type:"–Ø—Å–Ω–∞—è –ø–æ–≥–æ–¥–∞",weight:-1,comment:"‚ûñ –Ø—Å–Ω—ã–π –¥–µ–Ω—å - —Ä—ã–±–∞ –ø–∞—Å—Å–∏–≤–Ω–∞<br>",emoji:"‚òÄÔ∏è"}:{type:"–Ø—Å–Ω–∞—è –ø–æ–≥–æ–¥–∞",weight:-2,comment:"‚ö†Ô∏è –Ø—Å–Ω–∞—è –º–æ—Ä–æ–∑–Ω–∞—è –ø–æ–≥–æ–¥–∞ - –∫–ª—ë–≤ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç<br>",emoji:"‚ùÑÔ∏è"}}return null}getModelType(){return"cloudy"}getSeasonPositivePhrase(t){switch(t){case"summer":return"<b>‚úîÔ∏è –û–±–ª–∞—á–Ω–∞—è –ø–æ–≥–æ–¥–∞ —Å–Ω–∏–∂–∞–µ—Ç –∂–∞—Ä—É ‚Äî –æ—Ç–ª–∏—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –∫–ª—ë–≤–∞</b>";case"spring":return"<b>‚úîÔ∏è –°–æ–ª–Ω–µ—á–Ω—ã–µ —É—Ç—Ä–µ–Ω–Ω–∏–µ —á–∞—Å—ã –ø—Ä–æ–≥—Ä–µ–≤–∞—é—Ç –≤–æ–¥—É ‚Äî –∫–ª—ë–≤ –∞–∫—Ç–∏–≤–Ω—ã–π</b>";case"autumn":return"<b>‚úîÔ∏è –ü–∞—Å–º—É—Ä–Ω–∞—è –æ—Å–µ–Ω—å ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∫–ª—ë–≤ –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è</b>";case"winter":return"<b>‚úîÔ∏è –ü–∞—Å–º—É—Ä–Ω–∞—è –ø–æ–≥–æ–¥–∞ ‚Äî –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –∑–∏–º–Ω–µ–π —Ä—ã–±–∞–ª–∫–∏</b>";default:return"<b>‚úîÔ∏è –£—Å–ª–æ–≤–∏—è —Å–ø–æ—Å–æ–±—Å—Ç–≤—É—é—Ç –∞–∫—Ç–∏–≤–Ω–æ–º—É –∫–ª—ë–≤—É –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è</b>"}}getSeasonNegativePhrase(t){switch(t){case"summer":return"<b>‚ö†Ô∏è –ñ–∞—Ä–∫–∞—è —è—Å–Ω–∞—è –ø–æ–≥–æ–¥–∞ —Å–Ω–∏–∂–∞–µ—Ç –∫–ª—ë–≤ ‚Äî –ª—É—á—à–µ —Ä—ã–±–∞—á–∏—Ç—å —É—Ç—Ä–æ–º –∏–ª–∏ –≤–µ—á–µ—Ä–æ–º</b>";case"spring":return"<b>‚ö†Ô∏è –ü–ª–æ—Ç–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å –≤–µ—Å–Ω–æ–π –∑–∞–º–µ–¥–ª—è–µ—Ç –ø—Ä–æ–≥—Ä–µ–≤ –≤–æ–¥—ã ‚Äî –∫–ª—ë–≤ —É—Ö—É–¥—à–∞–µ—Ç—Å—è</b>";case"autumn":return"<b>‚ö†Ô∏è –ß—Ä–µ–∑–º–µ—Ä–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç –ø–æ–Ω–∏–∑–∏—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä—ã–±—ã</b>";case"winter":return"<b>‚ö†Ô∏è –Ø—Å–Ω—ã–µ –º–æ—Ä–æ–∑–Ω—ã–µ –¥–Ω–∏ —É—Ö—É–¥—à–∞—é—Ç –∫–ª—ë–≤ ‚Äî –ø–∞—Å–º—É—Ä–Ω–∞—è –ø–æ–≥–æ–¥–∞ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ</b>";default:return"<b>‚ö†Ô∏è –ù–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã–µ –ø–æ–≥–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è ‚Äî –∫–ª—é—ë—Ç —Ö—É–∂–µ</b>"}}}class T extends S{constructor(){super(),this.rainState={isRaining:!1,duration:0,lastType:null,previousHourWasRain:!1,totalRainDuration:0}}getModelType(){return"rain"}calculate(e,n){const[i,r]=e;this.rainState.totalRainDuration=0,this.postRainArr=[];const a=new Date(n),s=r.filter((t=>new Date(t.date)<a)).slice(-5),o=s.slice(-3).filter((t=>t.temp>25&&0===t.precipitations)).length,c=this.round(s.reduce(((t,e)=>t+e.temp),0)/5),l=s.filter((t=>0===t.precipitations)).length;this.environmentContext={avgTemp:c,dryDaysCount:l,wasHeatWave:3===o,lastRainDays:s.filter((t=>t.precipitations>0)).length};const d=p.getSeason(n),h=p.calculate(i),u={morning:[],day:[],evening:[]},m=[],g=[],y=[];this.impactsWeights=[];for(const[e,n]of Object.entries(h))if("night"!==e&&u[e])for(const i of n){const n=i.time?.slice(11,16)||"00:00",r=t.getWeatherType(i);let a=this.getImpact(r,d,e,n);if(a?this.impactsWeights.push(a.weight):this.impactsWeights.push(0),!a)continue;const s=t.getWeatherDescription(i)||a.description||"–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è",o=`${n} ${a.emoji} ${s} ‚Äî ${a.comment}`;u[e].push(o),y.push({type:a.type,weight:a.weight,comment:a.comment}),a.weight>0?m.push(a.weight):a.weight<0&&g.push(a.weight)}for(const t in u)u[t]=this.groupConsecutiveNotes(u[t]);const w=this.getGeneralConclusion(m,g,d,y);this.applyPostRainRecovery(),this.result={general:w,details:u,date:n,weights:this.getWeightsObject()}}groupConsecutiveNotes(t){if(!t.length)return[];const e=[];let n=null;for(const i of t){const t=i.match(/^(\d{2}:\d{2}) (.+?) ‚Äî (.+)$/);if(!t)continue;const[r,a,s,o]=t;n&&n.weatherType===s&&n.comment===o?n.endTime=a:(n&&e.push(this.formatNote(n)),n={startTime:a,endTime:a,weatherType:s,comment:o})}return n&&e.push(this.formatNote(n)),e}getImpact(t,e,n,i){const r=this.getRainIntensity(t);this.updateRainState(t,r);let a=null;return r?a=this.getCurrentRainImpact(t,e,r):this.rainState.previousHourWasRain&&(a=this.getPostRainImpact(e,i)),a&&"–ü–æ—Å–ª–µ –¥–æ–∂–¥—è"===a.type&&(a.description=" –ü–æ—Å–ª–µ –¥–æ–∂–¥—è"),a}getRainIntensity(t){return t?t.includes("–ú–æ—Ä–æ—Å—å")?t.includes("—Å–∏–ª—å–Ω–∞—è")?"HEAVY":"LIGHT":t.includes("–î–æ–∂–¥—å")?t.includes("—Å–ª–∞–±—ã–π")?"LIGHT":"MEDIUM":t.includes("–õ–∏–≤–µ–Ω—å")||t.includes("–ì—Ä–æ–∑–∞")?"HEAVY":null:null}updateRainState(t,e){e?(this.rainState.isRaining&&t===this.rainState.lastType?this.rainState.duration++:this.rainState.duration=1,this.rainState.totalRainDuration=(this.rainState.totalRainDuration||0)+1,this.rainState.isRaining=!0,this.rainState.lastType=t,this.rainState.lastRainType=t,this.rainState.previousHourWasRain=!0):(this.rainState.previousHourWasRain=this.rainState.isRaining,this.rainState.isRaining=!1,this.rainState.duration=0,this.rainState.lastType=null)}getCurrentRainImpact(t,e,n){const i=this.isProlongedRain(n),r=this.getBaseRainEffect(n,e);return i?{...r,weight:r.weight*("HEAVY"===n?1.8:1.5),comment:`${r.comment} ${this.getProlongedEffect(e)}`,isProlonged:!0}:r}isProlongedRain(t){return this.rainState.duration>={LIGHT:5,MEDIUM:4,HEAVY:3}[t]}getBaseRainEffect(t,e){return{LIGHT:{type:"\n‚õàÔ∏è –û—Å–∞–¥–∫–∏",weight:this.getDynamicWeight(1.2,e),comment:this.getLightRainComment(e),emoji:"‚òî"},MEDIUM:{type:"\n‚õàÔ∏è –û—Å–∞–¥–∫–∏",weight:-.8,comment:this.getMediumRainComment(e),emoji:"‚õàÔ∏è"},HEAVY:{type:"\n‚õàÔ∏è –û—Å–∞–¥–∫–∏",weight:-1.5,comment:this.getHeavyRainComment(e),emoji:"‚õàÔ∏è"}}[t]}getDynamicWeight(t,e){let n=t;return this.environmentContext?(this.environmentContext.avgTemp>24&&(n*=1.2,this.environmentContext.wasHeatWave&&(n*=1.2)),this.environmentContext.avgTemp<16&&(n*=.8),this.environmentContext.lastRainDays>0&&(n*=Math.max(.8,1-.08*this.environmentContext.lastRainDays)),this.round(n,2)):n}getPostRainImpact(t,e){if(!this.rainState.previousHourWasRain)return null;const n=this.calculateRecoveryTime(t),i=n>0,r=this.getDepthChange(t),a=this.calculateEffectWeight(t),s=this.rainState.duration<=1?this.buildRainComment(t,n,r):null,o=this.round(n,0),c={hour:e,recoveryTimeCalc:o,weightAfterRain:this.round(a,2)};return this.postRainArr.push(c),{type:"<br>üåà –ü–æ—Å–ª–µ –¥–æ–∂–¥—è "+(i?"‚ö†Ô∏è":"‚úîÔ∏è"),weight:0,comment:s,emoji:"üåà",recoveryTime:o,depthChange:r}}applyPostRainRecovery(){this.postRainArr.forEach((({hour:t,recoveryTimeCalc:e,weightAfterRain:n})=>{const[i]=t.split(":");let r=parseInt(i,10)-6,a=r+e;if(a<0||r>17)return;for(let t=r;t<a;t++)t>=0&&t<18&&(this.impactsWeights[t]=-1.5);let s=a,o=Math.min(s+8,18);for(let t=s;t<o&&t<18&&!(this.impactsWeights[t]<0);t++)this.impactsWeights[t]=1.2*n}))}calculateEffectWeight(t){let e=this.getBaseWeightForSeason(t);return this.environmentContext?(this.environmentContext.wasHeatWave?e+=1.2:this.environmentContext.avgTemp>24&&(e+=.7),e-=.3*(this.environmentContext.lastRainDays||0),e):e}buildRainComment(t,e,n){const i=[this.getPostRainComment(t)];return this.environmentContext&&(this.environmentContext.wasHeatWave?i.push("–ü–æ—Å–ª–µ 3 –¥–Ω–µ–π –∂–∞—Ä—ã —Ä—ã–±–∞ –æ—Å–æ–±–µ–Ω–Ω–æ –∞–∫—Ç–∏–≤–Ω–∞ –ø–æ—Å–ª–µ –¥–æ–∂–¥—è"):this.environmentContext.avgTemp>24&&i.push("–í—ã—Å–æ–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —É—Å–∏–ª–∏–≤–∞–µ—Ç —Ä–µ–∞–∫—Ü–∏—é –Ω–∞ –¥–æ–∂–¥—å")),e>0&&i.push(`–ö–ª–µ–≤ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —á–µ—Ä–µ–∑ ~${this.round(e,0)} —á.`),0!==n&&i.push(n>0?`–ò—â–∏—Ç–µ —Ä—ã–±—É –Ω–∞ ${n} –º –≥–ª—É–±–∂–µ –æ–±—ã—á–Ω–æ–≥–æ.`:`–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –º–µ—Å—Ç–∞ –Ω–∞ ${Math.abs(n)} –º –º–µ–ª—å—á–µ –ø—Ä–∏–≤—ã—á–Ω—ã—Ö.`),i.join(" ")}getBaseWeightForSeason(t){return{summer:2,spring:1.2,autumn:1,winter:.5}[t]||1}calculateRecoveryTime(t){const e=this.rainState.totalRainDuration||0;if(0===e)return 0;let n=Math.min(6,e/2)*{summer:.7,spring:1,autumn:.9,winter:1.5}[t]*((this.rainState.lastRainType||"").includes("–õ–∏–≤–µ–Ω—å")?1.3:1);return this.environmentContext&&(this.environmentContext.avgTemp>24&&(n*=.7),this.environmentContext.avgTemp<16&&(n*=1.2)),this.round(n,1)}getDepthChange(t){return this.rainState.totalRainDuration<2?0:{summer:1.5,spring:-.5,autumn:.7,winter:0}[t]}getProlongedEffect(t){switch(t){case"summer":return"(–ó–∞—Ç—è–∂–Ω–æ–π –¥–æ–∂–¥—å –ª–µ—Ç–æ–º —Å–Ω–∏–∂–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä—ã–±—ã –Ω–∞ 40%)";case"spring":return"(–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Å–∞–¥–∫–∏ –≤–µ—Å–Ω–æ–π –º–æ–≥—É—Ç –∏–∑–º–µ–Ω–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–∏)";default:return"(–î–ª–∏—Ç–µ–ª—å–Ω–æ–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ –æ—Å–∞–¥–∫–æ–≤)"}}getPostRainWeight(t){let e={summer:2.2,spring:1.5,autumn:1.3,winter:.5}[t];return this.environmentContext&&(this.environmentContext.avgTemp>24&&(e+=.8,this.environmentContext.wasHeatWave&&(e+=.5)),this.environmentContext.dryDaysCount>=3&&(e+=.5)),this.round(e,1)}getPostRainComment(t){switch(t){case"summer":return"‚úîÔ∏è –ü–æ—Å–ª–µ –ª–µ—Ç–Ω–µ–≥–æ –¥–æ–∂–¥—è –≤–æ–¥–∞ –Ω–∞—Å—ã—â–µ–Ω–∞ –∫–∏—Å–ª–æ—Ä–æ–¥–æ–º - –∏–¥–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –ª–æ–≤–ª–∏!";case"spring":return"‚úîÔ∏è –í–µ—Å–µ–Ω–Ω–∏–π –¥–æ–∂–¥—å –≤—ã–º—ã–ª –∫–æ—Ä–º - —Ä—ã–±–∞ –∞–∫—Ç–∏–≤–Ω–æ –ø–∏—Ç–∞–µ—Ç—Å—è";case"autumn":return"‚úîÔ∏è –ü–æ—Å–ª–µ –æ—Å–µ–Ω–Ω–µ–≥–æ –¥–æ–∂–¥—è –æ—Ç–º–µ—á–∞–µ—Ç—Å—è –≤—Å–ø–ª–µ—Å–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ä—ã–±—ã";default:return"‚úîÔ∏è –†—ã–±–∞ –≤–æ–∑–æ–±–Ω–æ–≤–ª—è–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ—Å–ª–µ –¥–æ–∂–¥—è"}}getLightRainComment(t){switch(t){case"summer":return"‚úîÔ∏è –õ—ë–≥–∫–∏–π –ª–µ—Ç–Ω–∏–π –¥–æ–∂–¥—å –æ—Ö–ª–∞–∂–¥–∞–µ—Ç –≤–æ–¥—É –∏ —É–ª—É—á—à–∞–µ—Ç –∫–ª—ë–≤. –ò–¥–µ–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —á–µ—Ä–µ–∑ 30-60 –º–∏–Ω –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞";case"spring":return"‚úîÔ∏è –ú–µ–ª–∫–∏–µ –æ—Å–∞–¥–∫–∏ –≤–µ—Å–Ω–æ–π –Ω–µ –æ—Ç–ø—É–≥–∏–≤–∞—é—Ç —Ä—ã–±—É ‚Äî –∫–ª—ë–≤ –≤–æ–∑–º–æ–∂–µ–Ω. –°–º—ã–≤–∞–µ—Ç –≤ –≤–æ–¥—É –¥–æ–∂–¥–µ–≤—ã—Ö —á–µ—Ä–≤–µ–π, –ª–∏—á–∏–Ω–æ–∫";case"autumn":return"‚úîÔ∏è –°–ª–∞–±—ã–π –¥–æ–∂–¥—å –æ—Å–µ–Ω—å—é –Ω–µ –º–µ—à–∞–µ—Ç –∫–ª—ë–≤—É";case"winter":return"‚úîÔ∏è –ï—Å–ª–∏ –Ω–µ—Ç –º–æ—Ä–æ–∑–∞, —Å–ª–∞–±—ã–µ –æ—Å–∞–¥–∫–∏ –∑–∏–º–æ–π –Ω–µ –º–µ—à–∞—é—Ç —Ä—ã–±–∞–ª–∫–µ";default:return"‚úîÔ∏è –û—Å–∞–¥–∫–∏ –Ω–µ –º–µ—à–∞—é—Ç –∫–ª—ë–≤—É"}}getMediumRainComment(t){switch(t){case"summer":return"‚ö†Ô∏è –£–º–µ—Ä–µ–Ω–Ω—ã–π –ª–µ—Ç–Ω–∏–π –¥–æ–∂–¥—å –≤—Ä–µ–º–µ–Ω–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä—ã–±—ã. –ü–µ—Ä–≤—ã–µ 20-30 –º–∏–Ω—É—Ç –≤–æ–∑–º–æ–∂–µ–Ω –≤—Å–ø–ª–µ—Å–∫ –∫–ª–µ–≤–∞, –∑–∞—Ç–µ–º –ø–∞—É–∑–∞ 1-2 —á–∞—Å–∞. –õ–µ—â —Å–º–µ—â–∞–µ—Ç—Å—è –Ω–∞ 0.5-1 –º –≥–ª—É–±–∂–µ –æ—Ç –ø—Ä–∏–≤—ã—á–Ω—ã—Ö —Å—Ç–æ—è–Ω–æ–∫.";case"spring":return"‚ö†Ô∏è –í–µ—Å–µ–Ω–Ω–∏–π –¥–æ–∂–¥—å —Å—Ä–µ–¥–Ω–µ–π —Å–∏–ª—ã —Å–æ–∑–¥–∞–µ—Ç –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è. –ö–ª–µ–≤ –≤–æ–∑–º–æ–∂–µ–Ω –≤ –º–µ—Å—Ç–∞—Ö –≤–ø–∞–¥–µ–Ω–∏—è —Ä—É—á—å–µ–≤, –≥–¥–µ –≤—ã–º—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä–º. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–¥–≤–∏–∂–Ω—ã–µ –ø—Ä–∏–º–∞–Ω–∫–∏ (–æ–ø–∞—Ä—ã—à –Ω–∞ –¥–≤–∏–∂—É—â–µ–π—Å—è –æ—Å–Ω–∞—Å—Ç–∫–µ).";case"autumn":return"‚ö†Ô∏è –û—Å–µ–Ω–Ω–∏–π –¥–æ–∂–¥—å –æ—Ö–ª–∞–∂–¥–∞–µ—Ç –≤–æ–¥—É, –∑–∞–º–µ–¥–ª—è—è –º–µ—Ç–∞–±–æ–ª–∏–∑–º —Ä—ã–±—ã. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞ –ª–æ–≤–ª—è –≤–ø–æ–ª–≤–æ–¥—ã —Å –º–µ–¥–ª–µ–Ω–Ω–æ–π –ø—Ä–æ–≤–æ–¥–∫–æ–π. –û–ø—Ç–∏–º–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ 1 —á–∞—Å –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ –¥–æ–∂–¥—è.";case"winter":return"‚ö†Ô∏è –î–æ–∂–¥—å –∑–∏–º–æ–π - —Ä–µ–¥–∫–æ–µ —è–≤–ª–µ–Ω–∏–µ, –æ–±—ã—á–Ω–æ –ø—Ä–∏ –æ—Ç—Ç–µ–ø–µ–ª–∏. –†—ã–±–∞ –º–æ–∂–µ—Ç –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∞–∫—Ç–∏–≤–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è —É –∫—Ä–æ–º–∫–∏ –ª—å–¥–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–ª–∫–∏–µ –º–æ—Ä–º—ã—à–∫–∏ —Å –º–æ—Ç—ã–ª–µ–º.";default:return"‚ö†Ô∏è –£–º–µ—Ä–µ–Ω–Ω—ã–µ –æ—Å–∞–¥–∫–∏ —Å–æ–∑–¥–∞—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –ª–æ–≤–ª–∏. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –≥–ª—É–±–∏–Ω–æ–π –∏ –ø—Ä–∏–º–∞–Ω–∫–∞–º–∏."}}getHeavyRainComment(t){switch(t){case"summer":return"‚ö†Ô∏è –°–∏–ª—å–Ω—ã–π –¥–æ–∂–¥—å –ª–µ—Ç–æ–º –≤—ã–∑—ã–≤–∞–µ—Ç –ø–æ–º—É—Ç–Ω–µ–Ω–∏–µ –≤–æ–¥—ã –∏ —Å–Ω–∏–∂–∞–µ—Ç –∫–ª—ë–≤. –ù–∞—á–∞–ª–æ –¥–æ–∂–¥—è: –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤—Å–ø–ª–µ—Å–∫ –∫–ª–µ–≤–∞ (20-40 –º–∏–Ω).";case"spring":return"‚ö†Ô∏è –í–µ—Å–µ–Ω–Ω–∏–π –ª–∏–≤–µ–Ω—å –º–æ–∂–µ—Ç –∏—Å–ø—É–≥–∞—Ç—å —Ä—ã–±—É ‚Äî –∫–ª—ë–≤ —É—Ö—É–¥—à–∞–µ—Ç—Å—è. –õ–µ—â –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º –¥–æ–∂–¥–µ —Å–º–µ—â–∞–µ—Ç—Å—è –∫ –ø—Ä–∏–±—Ä–µ–∂–Ω—ã–º –±—Ä–æ–≤–∫–∞–º";case"autumn":return"‚ö†Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω—ã–π –¥–æ–∂–¥—å –æ—Å–µ–Ω—å—é —É—Ö—É–¥—à–∞–µ—Ç –∫–ª—ë–≤ –∏ –¥–µ–ª–∞–µ—Ç —Ä—ã–±–∞–ª–∫—É –∑–∞—Ç—Ä—É–¥–Ω–∏—Ç–µ–ª—å–Ω–æ–π";case"winter":return"‚ö†Ô∏è –î–æ–∂–¥—å –∑–∏–º–æ–π —á–∞—Å—Ç–æ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç—Å—è –æ—Ç—Ç–µ–ø–µ–ª—å—é –∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å—é ‚Äî –∫–ª—ë–≤ —É—Ö—É–¥—à–∞–µ—Ç—Å—è";default:return"‚ö†Ô∏è –°–∏–ª—å–Ω—ã–µ –æ—Å–∞–¥–∫–∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ —Å–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –Ω–∞ –∫–ª—ë–≤–µ"}}getSeasonPositivePhrase(t){switch(t){case"summer":return"<br>‚úîÔ∏è –õ—ë–≥–∫–∏–µ –ª–µ—Ç–Ω–∏–µ –¥–æ–∂–¥–∏ –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã –¥–ª—è –∫–ª—ë–≤–∞, –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ—Å–ª–µ –∂–∞—Ä–∫–∏—Ö –ø–µ—Ä–∏–æ–¥–æ–≤";case"spring":return"<br>‚úîÔ∏è –í–µ—Å–µ–Ω–Ω–∏–µ –¥–æ–∂–¥–∏ –≤—ã–º—ã–≤–∞—é—Ç –∫–æ—Ä–º, –ø—Ä–∏–≤–ª–µ–∫–∞—è —Ä—ã–±—É –∫ –±–µ—Ä–µ–≥—É";case"autumn":return"<br>‚úîÔ∏è –û—Å–µ–Ω–Ω–∏–µ –º–æ—Ä–æ—Å—è—â–∏–µ –¥–æ–∂–¥–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä—ã–±—ã";case"winter":return"<br>‚úîÔ∏è –°–ª–∞–±—ã–µ –æ—Å–∞–¥–∫–∏ –∑–∏–º–æ–π –º–æ–≥—É—Ç –∞–∫—Ç–∏–≤–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä—ã–±—É –≤–æ –≤—Ä–µ–º—è –æ—Ç—Ç–µ–ø–µ–ª–∏";default:return"<br>‚úîÔ∏è –£–º–µ—Ä–µ–Ω–Ω—ã–µ –æ—Å–∞–¥–∫–∏ —Å–æ–∑–¥–∞—é—Ç —Ö–æ—Ä–æ—à–∏–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –ª–æ–≤–ª–∏"}}getSeasonNegativePhrase(t){switch(t){case"summer":return"‚ö†Ô∏è –°–∏–ª—å–Ω—ã–µ –ª–∏–≤–Ω–∏ –ª–µ—Ç–æ–º —Ä–µ–∑–∫–æ —É—Ö—É–¥—à–∞—é—Ç –∫–ª—ë–≤ –∏–∑-–∑–∞ –ø–æ–º—É—Ç–Ω–µ–Ω–∏—è –≤–æ–¥—ã";case"spring":return"‚ö†Ô∏è –ó–∞—Ç—è–∂–Ω—ã–µ –≤–µ—Å–µ–Ω–Ω–∏–µ –¥–æ–∂–¥–∏ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –ø–æ–¥—ä—ë–º—É –≤–æ–¥—ã –∏ —É—Ö—É–¥—à–µ–Ω–∏—é —É—Å–ª–æ–≤–∏–π";case"autumn":return"‚ö†Ô∏è –•–æ–ª–æ–¥–Ω—ã–µ –æ—Å–µ–Ω–Ω–∏–µ –¥–æ–∂–¥–∏ —Å–Ω–∏–∂–∞—é—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä—ã–±—ã –ø–µ—Ä–µ–¥ –∑–∏–º–æ–≤–∫–æ–π";case"winter":return"‚ö†Ô∏è –î–æ–∂–¥—å —Å–æ —Å–Ω–µ–≥–æ–º —Å–æ–∑–¥–∞—ë—Ç –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –∑–∏–º–Ω–µ–π —Ä—ã–±–∞–ª–∫–∏";default:return"‚ö†Ô∏è –°–∏–ª—å–Ω—ã–µ –æ—Å–∞–¥–∫–∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ –≤–ª–∏—è—é—Ç –Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä—ã–±—ã"}}round(t,e=0){return parseFloat(t.toFixed(e))}}class M extends S{constructor(){super()}calculate(t,e){const n=p.getSeason(e),i=p.calculate(t)||null,r=this.getPressureStats(t),a=this.getDailyFishingAnalysis(r,t),s={morning:[],day:[],evening:[]},o=[],c={night:this.getPressureStats(i.night||[]),morning:this.getPressureStats(i.morning||[]),day:this.getPressureStats(i.day||[]),evening:this.getPressureStats(i.evening||[])},l={morning:this.getImpact(c.morning,"morning",n,c.night),day:this.getImpact(c.day,"day",n,c.night,c.morning),evening:this.getImpact(c.evening,"evening",n,c.night,c.morning,c.day)};for(const[t,e]of Object.entries(l)){if(!e)continue;const n=this.getPressureTrendDescription(c[t]),i=`${e.timeRange} ${e.emoji} <b>üìâ –ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ:</b> ${n} ‚Äî ${e.comment}`;s[t].push(i),o.push({type:"üìà –ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ",weight:e.weight,comment:e.comment})}const d=this.getGeneralConclusion(a),h={general:a.weight,morning:l.morning.weight,day:l.day.weight,evening:l.evening.weight,model:"pressure"};this.result={general:`\n\n${d}`,details:s,date:e,weights:h}}getModelType(){return"pressure"}getImpact(t,e,n,i=null,r=null,a=null){const s=this.getTimeRangeForPeriod(e);let o=this.getBaseImpact(t);o=this.applySeasonalAdjustments(o,t,n,e),"morning"===e?this.analyzePressureBeforeMorning(o,t,i):"day"===e?this.analyzePressureBeforeDay(o,t,i,r,n):"evening"===e&&this.analyzePressureBeforeEvening(o,t,i,r,a,n);const c=this.getScoreEmoji(o.weight);return{...o,emoji:c,timeRange:s}}analyzePressureBeforeMorning(t,e,n){const{avg:i,min:r,max:a,delta:s,startValue:o,endValue:c,trend:l}=e,{avg:d,min:h,max:u,delta:m,startValue:g,endValue:p,trend:y}=n;t.comment+="<br>üìà –í–ª–∏—è–Ω–∏—è –Ω–æ—á–Ω–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è: ",y<-2?(t.weight=-3,t.comment+=`<br>üö´ –†–µ–∑–∫–æ–µ –Ω–æ—á–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è ${this.getTrendPrint(y)} –º–º ‚Äî –∫–ª—ë–≤ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (—Å—Ç—Ä–µ—Å—Å)`):-2===y?l>=1?(i>=740&&i<755&&(t.weight=2===t.weight?2:t.weight-1),t.comment+=`<br>‚ö†Ô∏è –†–æ—Å—Ç –¥–∞–≤–ª–µ–Ω–∏—è —É—Ç—Ä–æ–º ${this.getTrendPrint(l)} –º–º –ø–æ—Å–ª–µ –ø–∞–¥–µ–Ω–∏—è –Ω–æ—á—å—é (${this.getTrendPrint(y)} –º–º)  ‚Äî –≤–æ–∑–º–æ–∂–µ–Ω –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–ª—ë–≤`):l<-1?(t.weight=-3,t.comment+=`<br>üö´ –î–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ø–∞–¥–∞—Ç—å ${this.getTrendPrint(l)} –º–º ‚Äî —Ä—ã–±–∞ –≤ —Å—Ç—Ä–µ—Å—Å–µ`):0===l&&(t.weight=-3===t.weight?-3:t.weight-1,t.comment+=`<br>‚ö†Ô∏è –î–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–ª–æ—Å—å –ø–æ—Å–ª–µ –ø–∞–¥–µ–Ω–∏—è –Ω–æ—á—å—é (${this.getTrendPrint(y)} –º–º) ‚Äî –∫–ª—ë–≤ —Å–ª–∞–±—ã–π, –Ω–æ –≤–æ–∑–º–æ–∂–µ–Ω –≤–µ—á–µ—Ä–æ–º`):y>=2?i>=740&&i<755?l>=0?(t.comment+="<br>‚úîÔ∏è –ù–æ—á–Ω–æ–π —Ä–æ—Å—Ç –¥–∞–≤–ª–µ–Ω–∏—è ‚Äî —Ö–æ—Ä–æ—à–∏–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –ª–æ–≤–ª–∏",t.weight=Math.min(t.weight+1,2)):(t.comment+=`<br>‚ö†Ô∏è –ü–æ—Å–ª–µ —Ä–æ—Å—Ç–∞ –Ω–æ—á—å—é ${this.getTrendPrint(y)} –º–º –¥–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—á–∞–ª–æ –ø–∞–¥–∞—Ç—å ${this.getTrendPrint(l)} –º–º ‚Äî –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–∞–µ—Ç—Å—è`,t.weight=-3===t.weight?-3:t.weight-1):t.comment+=l>=0?"<br>‚ö†Ô∏è –ù–æ—á–Ω–æ–π —Ä–æ—Å—Ç –¥–∞–≤–ª–µ–Ω–∏—è ‚Äî —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç —É—Å—Ç–æ–π—á–∏–≤–æ–º—É –ø–æ–≤–µ–¥–µ–Ω–∏—é —Ä—ã–±—ã.":`<br>‚ö†Ô∏è –ü–æ—Å–ª–µ —Ä–æ—Å—Ç–∞ –Ω–æ—á—å—é ${this.getTrendPrint(y)} –º–º –¥–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—á–∞–ª–æ –ø–∞–¥–∞—Ç—å ${this.getTrendPrint(l)} –º–º ‚Äî –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–∞–µ—Ç—Å—è`:Math.abs(y)<=1&&(t.comment+=i>=740&&i<755?`<br>‚úîÔ∏è –ù–æ—á—å—é –¥–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ (${g} ‚Üí ${p} –º–º) ( ${this.getTrendPrint(y)} –º–º.) ‚Äî —Ä—ã–±–∞ –∞–∫—Ç–∏–≤–Ω–∞`:`<br>‚ö†Ô∏è –ù–æ—á—å—é –¥–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ (${g} ‚Üí ${p} –º–º) ${this.getTrendPrint(y)} –º–º. ‚Äî —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç —É—Å—Ç–æ–π—á–∏–≤–æ–º—É –ø–æ–≤–µ–¥–µ–Ω–∏—é —Ä—ã–±—ã.`)}analyzePressureBeforeDay(t,e,n,i,r){const{avg:a,min:s,max:o,delta:c,startValue:l,endValue:d,trend:h}=e,{avg:u,min:m,max:g,delta:p,startValue:y,endValue:w,trend:v}=n,{avg:f,min:$,max:D,delta:b,startValue:S,endValue:C,trend:T}=i,M=C-w,P=v>0&&T<0||v<0&&T>0;if(t.comment+="<br>üìà –í–ª–∏—è–Ω–∏—è –¥–∞–≤–ª–µ–Ω–∏—è –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –ø–µ—Ä–∏–æ–¥–µ: ",M<=-2?t.comment+=`<br>‚ö†Ô∏è –î–∞–≤–ª–µ–Ω–∏–µ —Å–Ω–∏–∑–∏–ª–æ—Å—å –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –ø–µ—Ä–∏–æ–¥–æ–º ${y}–º–º ‚Üí ${C}–º–º  ${this.getTrendPrint(M)} –º–º.`:M>=2?t.comment+=`<br>‚ö†Ô∏è –î–∞–≤–ª–µ–Ω–∏–µ –ø–æ–≤—ã—Å–∏–ª–æ—Å—å –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –ø–µ—Ä–∏–æ–¥–æ–º ${y}–º–º ‚Üí ${C}–º–º  ${this.getTrendPrint(M)} –º–º.`:Math.abs(M)<=1&&(t.comment+=`<br>‚úîÔ∏è –î–∞–≤–ª–µ–Ω–∏–µ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –ø–µ—Ä–∏–æ–¥–µ –±—ã–ª–æ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º ${y}–º–º ‚Üí ${C}–º–º  ${this.getTrendPrint(M)} –º–º.`),M<=-4)t.comment+=`<br>üåÄ <b>–ö–û–õ–õ–ê–ü–°</b>: –°—É—Ç–æ—á–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ ${this.getTrendPrint(M)} –º–º (–Ω–æ—á—å ${this.getTrendPrint(v)} –º–º, —É—Ç—Ä–æ ${this.getTrendPrint(T)})`,T>0&&h>=2?(t.weight=Math.min(t.weight,-1),t.comment+=`<br>‚ö†Ô∏è –£—Ç—Ä–µ–Ω–Ω–∏–π –∏ –¥–Ω–µ–≤–Ω–æ–π —Ä–æ—Å—Ç ${this.getTrendPrint(T+h)} –º–º —Å–≥–ª–∞–∂–∏–≤–∞—é—Ç –Ω–µ–≥–∞—Ç–∏–≤ ‚Äî –≤–æ–∑–º–æ–∂–Ω–∞ –∞–∫—Ç–∏–≤–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ 16:00`):(t.weight=-3,t.comment+=`<br>‚õî –î–∞–≤–ª–µ–Ω–∏–µ –ø–∞–¥–∞–ª–æ –≤—Å—é –Ω–æ—á—å –∏ —É—Ç—Ä–æ ${this.getTrendPrint(v+T)} ‚Äî –ª–µ—â —É—Ö–æ–¥–∏—Ç –≤ —è–º—É –∏ –º–æ–∂–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Å—Ç–∞—Ç—å –∫–æ—Ä–º–∏—Ç—å—Å—è`);else if(M>=5){const e=Math.abs(v)<=2&&T<=2;b<=2&&e?(t.weight=Math.min(t.weight+1,2),t.comment+=`<br>üìà –£—Å—Ç–æ–π—á–∏–≤—ã–π —Ä–æ—Å—Ç ${this.getTrendPrint(M)} –º–º ‚Äî –æ—Ç–ª–∏—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –¥–Ω–µ–≤–Ω–æ–≥–æ –∫–ª—ë–≤–∞ (13:00‚Äì15:30)`):(t.weight=-3===t.weight?-3:t.weight-1,t.comment+=`<br>‚ö†Ô∏è –ü–µ—Ä–µ–Ω–∞—Å—ã—â–µ–Ω–∏–µ: —Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä—ã–π —Ä–æ—Å—Ç –¥–∞–≤–ª–µ–Ω–∏—è ${this.getTrendPrint(v+T)} ‚Äî –≤–æ–∑–º–æ–∂–Ω–∞ –Ω–∞—Å—Ç–æ—Ä–æ–∂–µ–Ω–Ω–æ—Å—Ç—å —Ä—ã–±—ã`)}else P?v>2&&T<-2?(t.weight=-3,t.comment+=`<br>üö´ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–≤–æ—Ä–æ—Ç –¥–∞–≤–ª–µ–Ω–∏—è: –Ω–æ—á—å (${this.getTrendPrint(v)} –º–º) ‚Üí —É—Ç—Ä–æ (${this.getTrendPrint(T)} –º–º)  ‚Äî –¥–µ–∑–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è`):v<-3&&T>2&&(t.weight=Math.max(t.weight,0),t.comment+=`<br>‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–∞–¥–µ–Ω–∏—è –Ω–æ—á—å (${this.getTrendPrint(v)} –º–º) ‚Üí —É—Ç—Ä–æ (${this.getTrendPrint(T)} –º–º) ‚Äî –≤–æ–∑–º–æ–∂–µ–Ω –∫–ª—ë–≤ –≤–æ –≤—Ç–æ—Ä–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –¥–Ω—è`):M>-4&&M<=-3?(t.weight=-3===t.weight?-3:t.weight-1,t.comment+=`<br>‚ÜòÔ∏è –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏–æ–Ω–Ω—ã–π —Ä–µ–∂–∏–º  –Ω–æ—á—å  ${this.getTrendPrint(v)} ‚Üí —É—Ç—Ä–æ ${this.getTrendPrint(T)} ‚Äî –∏—â–∏—Ç–µ –Ω–∞ –≥–ª—É–±–∏–Ω–µ 6‚Äì8 –º`,T>=1&&(t.weight=0,t.comment+=`<br>‚ö° –£—Ç—Ä–µ–Ω–Ω–∏–π —Ä–æ—Å—Ç  ${this.getTrendPrint(T)} –º–º —á–∞—Å—Ç–∏—á–Ω–æ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç –Ω–æ—á–Ω–æ–π —Å–ø–∞–¥  ${this.getTrendPrint(v)}`)):M>=3&&M<5?T>=1&&h>=0&&b<=2?(t.weight=Math.min(t.weight+1,2),t.comment+=`<br>‚§¥Ô∏è –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π –¥–Ω–µ–≤–Ω–æ–π –ø–æ–¥—ä—ë–º –¥–∞–≤–ª–µ–Ω–∏—è ${this.getTrendPrint(h)} –º–º ‚Äî –≤–µ—Ä–æ—è—Ç–Ω—ã –ø–æ–∫–ª—ë–≤–∫–∏ –ø–æ—Å–ª–µ 13:00`):(t.weight=Math.min(t.weight,0),t.comment+="<br>‚ö†Ô∏è –î–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Ç—ë—Ç, –Ω–æ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ ‚Äî –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–µ—Ä—ã–≤–∏—Å—Ç–æ–π"):b<=2&&Math.abs(T)<=1&&(v>=2||Math.abs(v)<=1)&&(v>=2?(t.weight=Math.min(t.weight+1,2),t.comment+=`<br>üìä –ü–æ—Å–ª–µ –Ω–æ—á–Ω–æ–≥–æ –ø–æ–¥—ä—ë–º–∞ (${this.getTrendPrint(v)} –º–º) –¥–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–ª–æ—Å—å —É—Ç—Ä–æ–º (${f} –º–º) ‚Äî –≤–æ–∑–º–æ–∂–Ω–∞ –∞–∫—Ç–∏–≤–∏–∑–∞—Ü–∏—è –∫–ª—ë–≤–∞ –ø–æ—Å–ª–µ 13:00`):a>=740&&a<750?(t.comment+=`<br>‚úîÔ∏è –ù–æ—á—å –∏ —É—Ç—Ä–æ –±—ã–ª–∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã (${y} ‚Üí ${C} –º–º) ‚Äî –≤–æ–∑–º–æ–∂–µ–Ω —É–≤–µ—Ä–µ–Ω–Ω—ã–π –∫–ª—ë–≤`,t.weight=Math.min(t.weight+1,2)):t.comment+=`<br>‚ö†Ô∏è –î–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ (${y} ‚Üí ${C} –º–º), –Ω–æ —É—Ä–æ–≤–µ–Ω—å ${f} –º–º –º–æ–∂–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å`);const x=M<=-4?"8‚Äì10 –º (—Ä—É—Å–ª–æ–≤—ã–µ —è–º—ã)":h>=2&&a<=750?"4‚Äì5 –º (–±—Ä–æ–≤–∫–∏)":a>=755?"–≥–ª—É–±–∂–µ 6‚Äì7 –º (–≤—ã—Å–æ–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ)":"5‚Äì7 –º (–ø–µ—Ä–µ–ø–∞–¥—ã –≥–ª—É–±–∏–Ω)";t.comment+=`<br>üé£ –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –≥–ª—É–±–∏–Ω—ã: ${x}`,"winter"===r&&Math.abs(M)>=2?(t.weight=Math.max(t.weight-1,-3),t.comment+="<br>‚ùÑÔ∏è –ó–∏–º–æ–π –ª–µ—â –∫—Ä–∞–π–Ω–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –ø–µ—Ä–µ–ø–∞–¥–∞–º ‚Äî —Ä–∏—Å–∫ —É—Ö–æ–¥–∞ –≤ –ø–∞—Å—Å–∏–≤"):"summer"===r&&a>755&&(t.comment+="<br>‚òÄÔ∏è –ñ–∞—Ä–∫–æ–µ –ª–µ—Ç–æ: –∏—â–∏—Ç–µ —Ç–µ—Ä–º–æ–∫–ª–∏–Ω –Ω–∞ –≥–ª—É–±–∏–Ω–∞—Ö 5‚Äì6 –º ‚Äî –ª–µ—â –º–æ–∂–µ—Ç —Ç–∞–º –∑–∞–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è",t.weight=Math.min(t.weight,0)),a>=742&&a<=748&&b<=3&&(t.comment+=`<br>‚úîÔ∏è –î–∞–≤–ª–µ–Ω–∏–µ –≤ –∏–¥–µ–∞–ª—å–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ –¥–ª—è –î–Ω–µ–ø—Ä–∞ ${f} - ${a} –º–º ‚Äî –≤–æ–∑–º–æ–∂–Ω–∞ –¥–Ω–µ–≤–Ω–∞—è –∫–æ—Ä–º—ë–∂–∫–∞ –Ω–∞ —Å—Ä–µ–¥–Ω–∏—Ö –≥–ª—É–±–∏–Ω–∞—Ö`,t.weight=Math.min(t.weight+1,2))}analyzePressureBeforeEvening(t,e,n,i,r,a){const{avg:s,min:o,max:c,delta:l,startValue:d,endValue:h,trend:u}=e,{avg:m,delta:g,endValue:p,trend:y}=i,{avg:w,delta:v,endValue:f,trend:$}=r,{avg:D,delta:b,endValue:S,trend:C}=n,T=C+y+$,M=C>2&&y<-2||y>2&&$<-2,P=Math.abs(C)<=1&&Math.abs(y)<=1&&Math.abs($)<=1;t.comment+=`<br>üìä –î–∞–≤–ª–µ–Ω–∏–µ –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø–µ—Ä–∏–æ–¥: –Ω–æ—á—å ${this.getTrendPrint(C)}, —É—Ç—Ä–æ ${this.getTrendPrint(y)}, –¥–µ–Ω—å ${this.getTrendPrint($)} ‚Üí —Å—É–º–º–∞—Ä–Ω–æ: ${this.getTrendPrint(T)} –º–º`,T<=-5?(t.weight=-3,t.comment+="<br>‚ùå –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–π —Å—É—Ç–æ—á–Ω—ã–π —Å–ø–∞–¥ ‚Äî –ø–æ–ª–Ω–∞—è –ø–∞—Å—Å–∏–≤–Ω–æ—Å—Ç—å —Ä—ã–±—ã"):M?(t.weight=Math.min(t.weight,-2),t.comment+="<br>‚õî –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–≤–æ—Ä–æ—Ç –¥–∞–≤–ª–µ–Ω–∏—è ‚Äî —Ä—ã–±–∞ –¥–µ–∑–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞"):C<=-3&&y<=-2&&$<=-1?(t.weight=-3,t.comment+="<br>‚ùå –°—É—Ç–æ—á–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è ‚Äî –ª–µ—â –≤ –≥–ª—É–±–æ–∫–∏—Ö —è–º–∞—Ö"):P&&w>=740&&w<=750?(t.weight=Math.min(t.weight+1,2),t.comment+="<br>‚úîÔ∏è –ò–¥–µ–∞–ª—å–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å ‚Äî –ª—É—á—à–∏–π –≤–µ—á–µ—Ä–Ω–∏–π –∫–ª—ë–≤"):T>=3&&T<5&&$>=1?(t.weight=Math.min(t.weight+1,1),t.comment+="<br>üìà –ü–ª–∞–≤–Ω—ã–π —Å—É—Ç–æ—á–Ω—ã–π —Ä–æ—Å—Ç ‚Äî —Ö–æ—Ä–æ—à–∏–µ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã"):C<=-2&&y>=1&&$>=2?(t.weight=Math.min(t.weight,0),t.comment+="<br>‚ö†Ô∏è –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –¥–∞–≤–ª–µ–Ω–∏—è ‚Äî –∫–ª—ë–≤ –≤–æ–∑–º–æ–∂–µ–Ω –ø–æ—Å–ª–µ 20:00"):C>=2&&y>=2&&$<=-2?(t.weight=-3===t.weight?-3:t.weight-1,t.comment+="<br>‚ö†Ô∏è –†–∞–∑–≤–æ—Ä–æ—Ç (—Ä–æ—Å—Ç‚Üí–ø–∞–¥–µ–Ω–∏–µ) ‚Äî –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–ª—ë–≤"):C<=-2&&y<=-1&&$>=2?(t.weight=Math.min(t.weight,0),t.comment+="<br>‚ö†Ô∏è –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫ –ø–æ–∑–¥–Ω–µ–º—É –≤–µ—á–µ—Ä—É"):C<=-2&&y>=2&&$<=-2?(t.weight=Math.min(t.weight,-1),t.comment+="<br>‚ö†Ô∏è –ü–∏–ª–æ–≤–∏–¥–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å ‚Äî –∫—Ä–∞—Ç–∫–∏–µ –≤—Å–ø–ª–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏"):C>=2&&y<=-2&&$>=2?(t.weight=Math.min(t.weight,0),t.comment+="<br>‚ö†Ô∏è –ó–∏–≥–∑–∞–≥–æ–æ–±—Ä–∞–∑–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Äî –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π –∫–ª—ë–≤"):P&&$<=-2?(t.weight=Math.min(t.weight,0),t.comment+="<br>‚ö†Ô∏è –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å‚Üí–ø–∞–¥–µ–Ω–∏–µ ‚Äî –∫–ª—ë–≤ –¥–æ 20:00"):T>=4?(t.weight=2===t.weight?2:t.weight+1,t.comment+="<br>üìà –û–±—â–∏–π —Ä–æ—Å—Ç ‚Äî –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É—Å–∏–ª–µ–Ω–∏–µ –∫–ª—ë–≤–∞"):T>=6?(t.weight=Math.min(t.weight,-2),t.comment+="<br>‚õî –°–≤–µ—Ä—Ö—Ä–æ—Å—Ç ‚Äî —Ä—ã–±–∞ –Ω–∞—Å—Ç–æ—Ä–æ–∂–µ–Ω–∞"):T<=-4?(t.weight=-2,t.comment+=`<br>‚ÑπÔ∏è –£–º–µ—Ä–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (‚Üì Œî${Math.abs(T)}) ‚Äî –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∞`):(t.weight=Math.min(t.weight,0),t.comment+="<br>‚ÑπÔ∏è –£–º–µ—Ä–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Äî –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ç–æ—á–µ—á–Ω–∞—è");const x=T<=-4?"7‚Äì10 –º (—è–º—ã)":T>=3&&T<5?"4‚Äì5 –º (–ø–æ–ª–∏–≤—ã)":$>=2?"4‚Äì6 –º (–±—Ä–æ–≤–∫–∏)":w>=755?"6‚Äì8 –º (—Ç–µ—Ä–º–æ–∫–ª–∏–Ω)":"5‚Äì7 –º (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –≥–ª—É–±–∏–Ω—ã)";t.comment+=`<br>üé£ –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –≥–ª—É–±–∏–Ω—ã: ${x}`,"winter"===a?Math.abs(T)>=3&&(t.weight=Math.max(t.weight-1,-3),t.comment+="<br>‚ùÑÔ∏è –ó–∏–º–Ω—è—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏–∫–æ—Ä–º"):"summer"===a&&w>=755&&(t.comment+="<br>‚òÄÔ∏è –õ–µ—Ç–Ω—è—è –∂–∞—Ä–∞ ‚Äî –∏—â–∏—Ç–µ —Ç–µ–Ω–∏—Å—Ç—ã–µ —É—á–∞—Å—Ç–∫–∏"),w>=753&&w<=755&&T<=1&&(t.comment+="<br>‚ÑπÔ∏è –í—ã—Å–æ–∫–æ–µ, –Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ ‚Äî –ø—Ä–æ–±—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –≥–ª—É–±–∏–Ω—ã")}getGeneralConclusion(t){const{weight:e,comment:n}=t;let i=`\n\n ${this.getScoreEmoji(e)} <b>üìâ –ê–Ω–∞–ª–∏–∑ –¥–∞–≤–ª–µ–Ω–∏—è –∑–∞ –¥–µ–Ω—å:</b> \n`;return i+=`\n${n}\n`,i+=e>0?this.getPositivePhrase(e):e<0?this.getNegativePhrase(e):this.getNeutralPhrase(e),i}getScoreEmoji(t){return 0==t?"":t>0?"‚úîÔ∏è":t<=-2?"üö´":"‚ö†Ô∏è"}getTrendPrint(t){return`(<span style="color: ${t>0?"#2ecc71":t<0?"#e74c3c":"#3498db"}">${t>0?"‚Üë":t<0?"‚Üì":"‚Üí"} Œî${Math.abs(t)}</span>)`}getDailyFishingAnalysis(t,e){const n=this.getBaseHourlyImpact(t),i=e.slice(6,12),r=e.slice(12,18),a=e.slice(18,24),s=this.getPressureStats(i),o=this.getPressureStats(r),c=this.getPressureStats(a),l=`\n\t\n\t\tüåÖ –£—Ç—Ä–æ: ${s.startValue} - ${s.endValue} –º–º —Ä—Ç.—Å—Ç. (${this.getTrendPrint(s.trend)}  –∫–æ–ª–µ–±–∞–Ω–∏–µ Œî${s.delta})<br>\n\t\t‚òÄÔ∏è –î–µ–Ω—å: ${o.startValue} - ${o.endValue} –º–º —Ä—Ç.—Å—Ç. (${this.getTrendPrint(o.trend)} –∫–æ–ª–µ–±–∞–Ω–∏–µ Œî${o.delta})<br>\n\t\tüåá –í–µ—á–µ—Ä: ${c.startValue} - ${c.endValue} –º–º —Ä—Ç.—Å—Ç. (${this.getTrendPrint(c.trend)} –∫–æ–ª–µ–±–∞–Ω–∏–µ Œî${c.delta})<br>\n\t`.trim(),d=`${n.comment}<br>${l}`;return{weight:n.weight,comment:d}}getBaseHourlyImpact(t){const{avg:e,min:n,max:i,delta:r,startValue:a,endValue:s,trend:o}=t;let c=`–°—É—Ç–æ—á–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ: <b>${a} ‚Üí ${s}</b> –º–º —Ä—Ç.—Å—Ç. (${this.getTrendPrint(o)})`,l=0,d=[];return e<=735?(d.push(`üö´ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –Ω–∏–∑–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ (${e} –º–º) - —Ä—ã–±–∞ –≤ –≥–ª—É–±–æ–∫–∏—Ö —è–º–∞—Ö, –∫–ª—ë–≤ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç`),l=-3):e>765&&(d.push(`üö´ –û—á–µ–Ω—å –≤—ã—Å–æ–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ (${e} –º–º) - –ª–µ—â –ø–∞—Å—Å–∏–≤–µ–Ω`),l=-3),o<=-7?(d.push(`üåÄ –ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–æ–µ –ø–∞–¥–µ–Ω–∏–µ (${Math.abs(o)} –º–º –∑–∞ —Å—É—Ç–∫–∏) - –ø–æ–ª–Ω–æ–µ –ø—Ä–µ–∫—Ä–∞—â–µ–Ω–∏–µ –∫–ª—ë–≤–∞ –Ω–∞ 24+ —á–∞—Å–∞`),l=-3):o<=-5?(d.push(`‚ö†Ô∏è –°–∏–ª—å–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ (${Math.abs(o)} –º–º) - –∫–ª—ë–≤ –æ—á–µ–Ω—å —Å–ª–∞–±—ã–π`),l=-2):o>=7?(d.push(`üìà –°–∏–ª—å–Ω—ã–π —Ä–æ—Å—Ç (+${o} –º–º/24—á) - –≤–æ–∑–º–æ–∂–µ–Ω –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∂–æ—Ä`),l=Math.min(l+1,1)):o>=5&&(d.push(`‚§¥Ô∏è –ó–∞–º–µ—Ç–Ω—ã–π —Ä–æ—Å—Ç (+${o} –º–º) - —Ö–æ—Ä–æ—à–∏–µ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã`),l=Math.min(l+1,1)),r>7?(d.push(`üåÄ –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è (Œî${r} –º–º) - —Ä—ã–±–∞ –≤ —Å—Ç—Ä–µ—Å—Å–µ`),l=Math.min(l,-2)):r>4&&(o<0?(d.push(`‚ö†Ô∏è –†–µ–∑–∫–∏–µ –ø–µ—Ä–µ–ø–∞–¥—ã (Œî${r} –º–º) + –æ–±—â–µ–µ –ø–∞–¥–µ–Ω–∏–µ - –∫—Ä–∏—Ç–∏—á–Ω–æ`),l=Math.min(l,-2)):(d.push(`‚ÜòÔ∏è –ó–∞–º–µ—Ç–Ω—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è (Œî${r} –º–º) - –≤–æ–∑–º–æ–∂–Ω—ã –≤—Å–ø–ª–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏`),l=Math.min(l,-1))),l>-3&&e>=745&&e<=755&&r<=3&&Math.abs(o)<=3&&(d.push("‚úîÔ∏è –ò–¥–µ–∞–ª—å–Ω–æ: —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ –≤ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ"),l=2),c+="<br>"+d.join("<br>"),{weight:Math.max(Math.min(l,2),-3),comment:c}}getBaseImpact(t){const{avg:e,min:n,max:i,delta:r,startValue:a,endValue:s,trend:o}=t;let c=`–î–∞–≤–ª–µ–Ω–∏–µ <b>${a} - ${s}</b> –º–º —Ä—Ç.—Å—Ç. ${this.getTrendPrint(o)}`,l=0,d=[];return r<=1&&Math.abs(o)<=1?c+=" (–°—Ç–∞–±–∏–ª—å–Ω–æ–µ)":c+=" (–ò–∑–º–µ–Ω—è–ª–æ—Å—å)",c+="<br>",e<=735?(d.push(`üö´ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –Ω–∏–∑–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ ${e} –º–º —Ä—Ç.—Å—Ç.`),l=-3):e>765&&(d.push(`üö´ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤—ã—Å–æ–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ ${e} –º–º —Ä—Ç.—Å—Ç.`),l=-3),l>-3&&(e>=745&&e<=755?r<=1?(d.push(`‚úîÔ∏è –ò–¥–µ–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è: —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ ${e} –º–º —Ä—Ç.—Å—Ç.`),l=2):r<=2&&(d.push(`‚úîÔ∏è –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ ${e} –º–º —Ä—Ç.—Å—Ç.`),l=1):e>=740&&e<=745?r<=1?(d.push(`‚úîÔ∏è –ö–æ–º—Ñ–æ—Ä—Ç–Ω–æ–µ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ ${e} –º–º —Ä—Ç.—Å—Ç.`),l=1):r<=2&&(d.push(`–ö–æ–º—Ñ–æ—Ä—Ç–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ ${e} –º–º —Ä—Ç.—Å—Ç.`),l=0):e>755&&e<=765?(d.push(`‚ö†Ô∏è –ü–æ–≤—ã—à–µ–Ω–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ ${e} –º–º —Ä—Ç.—Å—Ç. ‚Äî –ª–µ—â –º–æ–∂–µ—Ç —É–π—Ç–∏ –Ω–∞ –≥–ª—É–±–∏–Ω—É`),l=-1):e<740&&e>=736&&(d.push(`‚ö†Ô∏è –°—Ä–µ–¥–Ω–µ–µ –¥–∞–≤–ª–µ–Ω–∏–µ ${e} –º–º —Ä—Ç.—Å—Ç. –Ω–∏–∂–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–≥–æ –¥–ª—è –ª–µ—â–∞ ‚Äî –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–∞–¥–∞–µ—Ç`),l=-1)),r>1&&l>-3&&(r>4?(d.push(`üö´ –†–µ–∑–∫–∏–π –ø–µ—Ä–µ–ø–∞–¥ –¥–∞–≤–ª–µ–Ω–∏—è Œî${r} –º–º, —Ç—Ä–µ–Ω–¥ ${this.getTrendPrint(o)} –º–º –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–±–∏–≤–∞–µ—Ç –∫–ª—ë–≤`),l=-3):r>2?(d.push(`‚ö†Ô∏è –°—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è –¥–∞–≤–ª–µ–Ω–∏—è Œî${r} –º–º, —Ç—Ä–µ–Ω–¥ ${this.getTrendPrint(o)} –º–º –º–µ—à–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ–º—É –∫–ª—ë–≤—É`),l=Math.min(l,-2)):l<2&&(d.push(`‚ÜîÔ∏è –ù–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è –¥–∞–≤–ª–µ–Ω–∏—è Œî${r} –º–º, —Ç—Ä–µ–Ω–¥ ${this.getTrendPrint(o)} –º–º  - –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –∫–ª–µ–≤`),l=Math.min(l,0))),r<=4&&l>-3&&Math.abs(o)>3&&(d.push(`‚ö†Ô∏è –ó–∞–º–µ—Ç–Ω—ã–π ${o>0?"—Ä–æ—Å—Ç":"—Å–ø–∞–¥"} ${this.getTrendPrint(o)}`),l=Math.min(l,-1)),c+=d.join("<br>"),d.filter((t=>t.includes("‚ö†Ô∏è")||t.includes("üö´"))).length>=2&&l>-3&&(l=Math.min(l,-2)),{weight:l,comment:c}}getDayPressureStats(t){const e=[];if(t.forEach((t=>{const n=t.comment.match(/–¥–∞–≤–ª–µ–Ω–∏–µ (\d+)/i);n&&e.push(parseInt(n[1]))})),0===e.length)return null;const n=Math.min(...e),i=Math.max(...e),r=e[0],a=e[e.length-1];return{min:n,max:i,start:r,end:a,delta:i-n,trend:a-r}}applySeasonalAdjustments(t,e,n,i){let r={...t};return"winter"===n&&e.avg>=750&&e.delta<=2&&(r.weight+=1,r.comment+=`<br>‚úîÔ∏è –ó–∏–º–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤—ã—Å–æ–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ ${e.avg} –º–º —Ä—Ç.—Å—Ç. —É–ª—É—á—à–∞–µ—Ç –∫–ª—ë–≤`),"summer"===n&&"day"===i&&e.avg<740&&(r.weight-=.5,r.comment+=`<br>‚ö†Ô∏è –õ–µ—Ç–æ–º –Ω–∏–∑–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ –¥–Ω—ë–º ${e.avg} –º–º —Ä—Ç.—Å—Ç. –º–æ–∂–µ—Ç —Å–Ω–∏–∂–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä—ã–±—ã`),("spring"===n||"autumn"===n)&&e.delta>2&&(r.comment+=`<br>(–≤ ${n} —Ä—ã–±–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –∫ –ø–µ—Ä–µ–ø–∞–¥–∞–º)`),r}getPressureStats(t){const e=t.filter((t=>null!==t&&!isNaN(t)));if(0===e.length)return{avg:0,min:0,max:0,delta:0};const n=this.round(e.reduce(((t,e)=>t+e),0)/e.length),i=Math.min(...e),r=Math.max(...e),a=r-i,s=e[0],o=e[e.length-1];return{avg:n,min:i,max:r,delta:a,startValue:s,endValue:o,trend:o-s}}getPressureEmoji(t){return t.delta>4?"üîÑ üö´":t.avg<735?"‚¨áÔ∏è üö´":t.avg>765?"‚¨ÜÔ∏è üö´":t.avg>=750&&t.avg<=758&&t.delta<=1||t.avg>=745&&t.avg<750?"‚úîÔ∏è":"‚ÜîÔ∏è"}round(t,e=0){return parseFloat(t.toFixed(e))}getPressureTrendDescription(t){if(!t)return"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –¥–∞–≤–ª–µ–Ω–∏–∏";const e=t.trend>0?"‚Üë":t.trend<0?"‚Üì":"‚Üí",n=t.trend>0?"#2ecc71":t.trend<0?"#e74c3c":"#3498db",i=0!==t.trend?`(<span style="color: ${n}">${e} Œî${t.trend}</span>)`:"(‚Üí 0)",r=`–î–∞–≤–ª–µ–Ω–∏–µ <b>${t.startValue}</b> - <b>${t.endValue}</b> –º–º —Ä—Ç.—Å—Ç. ${i}`;let a="";return t.trend>3?a=`üö´ üîÑ –†–µ–∑–∫–∏–µ —Å–∫–∞—á–∫–∏ –¥–∞–≤–ª–µ–Ω–∏—è ${t.delta} –º–º.—Ä—Ç.—Å—Ç`:t.trend<=1?a=" ‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω–æ–µ":t.trend>1?a=` üìà ‚¨ÜÔ∏è –ü–ª–∞–≤–Ω—ã–π —Ä–æ—Å—Ç –Ω–∞ (${t.trend} –º–º —Ä—Ç.—Å—Ç.)`:t.trend<1&&(trendText=` üìâ ‚¨áÔ∏è –ü–ª–∞–≤–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞ (${t.trend} –º–º —Ä—Ç.—Å—Ç.)`),`${r}${a}`}getTimeRangeForPeriod(t){switch(t){case"morning":return"06:00‚Äì12:00";case"day":return"12:00‚Äì18:00";case"evening":return"18:00‚Äì00:00";case"night":return"00:00‚Äì06:00";default:return""}}getPositivePhrase(t){return"<br><b>üìå –ë–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–º—É –∫–ª—ë–≤—É</b>"}getNegativePhrase(t){return"<br><b>üìå –ù–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ —Å–Ω–∏–∂–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä—ã–±—ã. –í—ã–±–∏—Ä–∞–π—Ç–µ –ø–µ—Ä–∏–æ–¥—ã —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏ –¥–∞–≤–ª–µ–Ω–∏—è</b>"}getNeutralPhrase(t){return"<br><b>üìå –î–∞–≤–ª–µ–Ω–∏–µ –Ω–µ –æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤–ª–∏—è–Ω–∏—è</b>"}}class P{renderMainCurrentDay(t){this.container=document.querySelector(`[data-date="${t.date}"]`),this.mainTodayMainContainer=this.container?.querySelector(".detail-today-main-fishing__main"),this.mainMorningMainContainer=this.container?.querySelector(".detail-morning-main-fishing"),this.mainDayMainContainer=this.container?.querySelector(".detail-day-main-fishing"),this.mainEveningMainContainer=this.container?.querySelector(".detail-evening-main-fishing");const e=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div"),r=document.createElement("div");e.innerHTML=`\n\t\t<div> \n\t\t   ${t.general||""}\n\t\t</div>\n\t\t`,n.innerHTML=`\n\t\t<div>${this.buildHtmlDay(t.details.morning)}</div>\n\t\t`,i.innerHTML=`\n\t\t<div>${this.buildHtmlDay(t.details.day)}</div>\n\t\t`,r.innerHTML=`\n\t\t<div>${this.buildHtmlDay(t.details.evening)}</div>\n\t\t`,this.mainTodayMainContainer?.appendChild(e),this.mainMorningMainContainer?.appendChild(n),this.mainDayMainContainer?.appendChild(i),this.mainEveningMainContainer?.appendChild(r)}buildHtmlDay(t){return`<ul>${t.reduce(((t,e)=>t+"<li>"+e+"</li>"),"")||""}</ul>`}}class x{constructor(t=[]){this.models=t,this.results={},this.mainFishingForecastRender=new P}calculateAll(t,e,n){const i={},r=t=>null==t?[]:Array.isArray(t)?t:[t];for(const a of this.models)try{let s,o=a.getModelType();if(s=o.includes("pressure")?r(e?.pressures||[]):o.includes("wind")?[r(e?.winds||[]),r(e?.pressures||[])]:o.includes("precipitation")?r(n||[]):o.includes("rain")?[r(e?.weatherCodes||[]),r(n||[])]:r(e?.weatherCodes||[]),!s||Array.isArray(s)&&s.some((t=>void 0===t))){console.warn(`Invalid data for ${a.constructor.name}:`,s);continue}a.calculate(s,t),i[o.replace("model","")]=a.getResult()}catch(t){console.error(`Error in ${a.constructor.name}:`,t)}return this.results[t]=i,this.results[t]}getCombinedResult(t){const e=this.results[t];if(!e)return null;const n={date:t,details:{morning:[],day:[],evening:[]},general:[],weights:{general:null,morning:null,day:null,evening:null,model:null}};for(const t in e){const i=e[t];if(i?.details)for(const t of["morning","day","evening"])n.details[t].push(...i.details[t]||[]);i?.general&&n.general.push(`<div class="model-summary">${i.general}</div>`)}for(const t of Object.keys(n.details))0===n.details[t].length&&delete n.details[t];return n.general=this.mergeGeneral(n.general),this.mainFishingForecastRender.renderMainCurrentDay(n),n}mergeGeneral(t){if(!t||0===t.length)return"";const e=[];for(const n of t)n.includes("üìä –í —Ü–µ–ª–æ–º:")?e.push(n.replace("üìä –í —Ü–µ–ª–æ–º:","").trim()):e.push(n);const n=[...new Set(e)];return 0===n.length?"":1===n.length?`üìä –í —Ü–µ–ª–æ–º: ${n[0]}`:`üìä –í —Ü–µ–ª–æ–º: ${n.join(". ")}`}}class I{constructor(){}renderScoreCurrentDay(t){console.log("scoreData",t),this.container=document.querySelector(`[data-date="${t.date}"]`),this.scoreMorningMainContainer=this.container?.querySelector(".detail-card__morning-fishing"),this.scoreDayMainContainer=this.container?.querySelector(".detail-card__day-fishing"),this.scoreEveningMainContainer=this.container?.querySelector(".detail-card__evening-fishing"),this.scoreMorningMainContainer.classList.add(`${t.morning.ratingForCSS}`),this.scoreDayMainContainer.classList.add(`${t.day.ratingForCSS}`),this.scoreEveningMainContainer.classList.add(`${t.evening.ratingForCSS}`),this.scoreMorningDescriptin=this.scoreMorningMainContainer?.querySelector(".detail-card__morning-descriptin"),this.scoreDayDescriptin=this.scoreDayMainContainer?.querySelector(".detail-card__day-descriptin"),this.scoreEveningDescriptin=this.scoreEveningMainContainer?.querySelector(".detail-card__evening-descriptin"),this.scoreMorningDescriptin.innerHTML=`\n\t\t<b>–ü—Ä–æ–≥–Ω–æ–∑ - ${t.morning.rating||""}.</b> ${t.morning.message||""}`,this.scoreDayDescriptin.innerHTML=`\n\t\t<b>–ü—Ä–æ–≥–Ω–æ–∑ - ${t.day.rating||""}.</b> ${t.day.message||""}`,this.scoreEveningDescriptin.innerHTML=`\n\t\t<b>–ü—Ä–æ–≥–Ω–æ–∑ - ${t.evening.rating||""}.</b> ${t.evening.message||""}`}}class _{constructor(){this.scoreFishingForecastRender=new I,this.baseActivity=.5,this.criticalThresholds={pressure:-2.5,precipitation:-2,wind:-2,rain:-1.5,cloudy:-1.5,season:0},this.timeFactors={morning:1.1,day:.8,evening:1}}getWeights(t){return"day"===t?{pressure:.2,temperature:.28,wind:.18,precipitation:.1,cloudy:.14,rain:.05,moon:.05}:{pressure:.25,temperature:.22,wind:.15,precipitation:.12,cloudy:.1,rain:.08,moon:.08}}normalizeValues(t){return{pressure:t.pressure,precipitation:t.precipitation,wind:this.normalizeWind(t.wind),cloudy:t.cloudy,rain:this.normalizeRain(t.rain),moon:t.moon,temperature:t.temperature,season:this.normalizeSeson(t.season)}}normalizeSeson(t){return{very_weak:0,weak:1,medium:2,good:3,excellent:4}[t]??0}normalizeWind(t){return{4:2,3:1,2:-1,1:-2}[t]??0}normalizeRain(t){return t<=-1.5?-1.5:0===t?0:t>0&&t<=2.6?1.3*t:t>2.6?2.6:t<-1.5?-1.5:t}checkCriticalConditions(t){const e={};return t.pressure<=this.criticalThresholds.pressure&&(e.pressure="–¥–∞–≤–ª–µ–Ω–∏—è"),t.precipitation<=this.criticalThresholds.precipitation&&(e.precipitation="–æ—Å–∞–¥–∫–æ–≤"),t.wind<=this.criticalThresholds.wind&&(e.wind="–≤–µ—Ç—Ä–∞"),t.rain<=this.criticalThresholds.rain&&(e.rain="–¥–æ–∂–¥—è"),t.cloudy<=this.criticalThresholds.cloudy&&(e.cloudy="–∂–∞—Ä–∞ –∏ –±–µ–∑–æ–±–ª–∞—á–Ω–∞—è –ø–æ–≥–æ–¥–∞"),t.season<=this.criticalThresholds.season&&(e.season="—Å–µ–∑–æ–Ω–∞"),Object.keys(e).length>0?e:null}calculateBiteScore(t,e){const n=this.normalizeValues(t),i=this.checkCriticalConditions(n);if(i)return{scoreSeason:0,score:-3,rating:"–ö–ª—ë–≤–∞ –Ω–µ—Ç",ratingForCSS:"very_weak",message:`–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã: ${Object.entries(i).map((([t,e])=>`–≤–ª–∏—è–Ω–∏–µ ${e}`)).join("; ")}`,normalizedScores:n};const r=this.getWeights(e);let a=this.baseActivity+r.pressure*n.pressure+r.temperature*n.temperature+r.precipitation*n.precipitation+r.wind*n.wind+r.cloudy*n.cloudy+r.rain*n.rain+r.moon*n.moon;-2===n.moon?a*=.4:-1===n.moon&&(a*=.9),e&&this.timeFactors[e]&&(a*=this.timeFactors[e]),"day"===e?(n.temperature<=0||n.cloudy<0||n.wind<0)&&(a*=.5):n.wind<0&&(a*=.5),-2===n.pressure?a*=.3:n.pressure<=-1&&(a*=.5),-1.5===n.precipitation&&(a*=.3);let s=0;a>=1.3?s=1:a<=.3?s=-3:a<=.6&&(s=-2);let o=n.season+s;return o=Math.max(0,Math.min(4,o)),{scoreSeason:o,score:a,rating:["–ö–ª—ë–≤–∞ –Ω–µ—Ç","–°–ª–∞–±—ã–π","–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π","–•–æ—Ä–æ—à–∏–π","–û—Ç–ª–∏—á–Ω—ã–π"][o],ratingForCSS:["very_weak","weak","medium","good","excellent"][o],message:["–†—ã–±–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–∞—Å—Å–∏–≤–Ω–∞","–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, —Å–ª–∞–±—ã–π –∫–ª—ë–≤","–£–º–µ—Ä–µ–Ω–Ω—ã–π –∫–ª—ë–≤, –Ω—É–∂–Ω–∞ —Ç–∞–∫—Ç–∏–∫–∞","–ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –¥–ª—è —Ä—ã–±–∞–ª–∫–∏","–ê–∫—Ç–∏–≤–Ω—ã–π –∂–æ—Ä, –∏–¥–µ–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è"][o],normalizedScores:n}}getTimeOfDayForecast(t,e,n,i){const r={date:i,morning:this.calculateBiteScore(t,"morning"),day:this.calculateBiteScore(e,"day"),evening:this.calculateBiteScore(n,"evening")};this.scoreFishingForecastRender.renderScoreCurrentDay(r)}calculateFromCombinedData(t){const e={pressure:t.pressure?.morning??0,precipitation:t.precipitation?.general??0,wind:t.wind?.morning??0,cloudy:t.cloudy?.morning??0,rain:t.rain?.morning??0,moon:t.moon?.morning??0,temperature:t.temperature?.morning??0,season:t.season?.general??0},n={pressure:t.pressure?.day??0,precipitation:t.precipitation?.general??0,wind:t.wind?.day??0,cloudy:t.cloudy?.day??0,rain:t.rain?.day??0,moon:t.moon?.day??0,temperature:t.temperature?.day??0,season:t.season?.general??0},i={pressure:t.pressure?.evening??0,precipitation:t.precipitation?.general??0,wind:t.wind?.evening??0,cloudy:t.cloudy?.evening??0,rain:t.rain?.evening??0,moon:t.moon?.evening??0,temperature:t.temperature?.evening??0,season:t.season?.general??0},r=t.date;return this.getTimeOfDayForecast(e,n,i,r)}}class E{constructor(t,e){this.localFiles=t,this.weatherModel=e,this.precipitationModel=b,this.lunarModel=new w(this.localFiles?.moonCalendar,this.localFiles?.moonTerms),this.seasonModel=new f,this.aggregator=new x([new C,new T,new $,new M,new b]),this.fishBiteForecast=new _}calculateFishingForecast(){const t=new Date,e=this.weatherModel.processorHistoricalData.dataTotalStats,n=this.weatherModel.data.stats,i=p.normalizePrecipitationsData(n,e);for(let e=0;e<6;e++){const n=new Date(t);n.setDate(t.getDate()+e);const r=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`,a=this.weatherModel?.data?.stats[`${r}`]?.weatherCodes?.description||"–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å",s=this.lunarModel?.calculate(n,a),o=this.seasonModel?.calculate(r,this.localFiles.calendar),c=this.weatherModel.data.daily[`${r}`],l=this.aggregator.calculateAll(r,c,i),[d,h,u]=p.calcTempAvgCurrentTemp(r,i);this.temperatureModel=new D(u,h,d);const m=this.temperatureModel.getForecast(),g={date:r,temperature:{morning:m.morning,day:m.day,evening:m.evening},cloudy:{morning:l.cloudy.weights.morning,day:l.cloudy.weights.day,evening:l.cloudy.weights.evening},rain:{morning:l.rain.weights.morning,day:l.rain.weights.day,evening:l.rain.weights.evening},wind:{morning:l.wind.weights.morning,day:l.wind.weights.day,evening:l.wind.weights.evening},pressure:{morning:l.pressure.weights.morning,day:l.pressure.weights.day,evening:l.pressure.weights.evening},precipitation:{general:l.precipitations.weights.general},moon:{morning:s.morning,day:s.day,evening:s.evening},season:{general:o.level}};this.fishBiteForecast.calculateFromCombinedData(g),this.aggregator.getCombinedResult(r)}}}class H{static setTodayDataAttribute(){const t=document.querySelector(".js-current-fishing");if(!t)return;const e=new Date,n=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`;t.setAttribute("data-date",n)}static renderForecastItems(t){const e=document.querySelector("#fishing-forecast-5days"),n=e.querySelector(".js-fishing-forecast-item");if(!n||!e)return;n.style.display="none";const i=new Date;for(let r=1;r<=t;r++){const t=new Date(i);t.setDate(i.getDate()+r);const a=n.cloneNode(!0),s=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;a.setAttribute("data-date",s),a.style.display="";const o=a.querySelector(".current-date-fishing");o&&(o.textContent=t.toLocaleDateString("ru-RU",{day:"numeric",month:"long",weekday:"short"})),e.appendChild(a)}}static init(){this.setTodayDataAttribute(),this.renderForecastItems(5)}}class A{static show(t){console.error(t)}}function R(){const t=document.querySelectorAll("[data-spollers]");if(t.length>0){const r=Array.from(t).filter((function(t,e,n){return!t.dataset.spollers.split(",")[0]}));r.length>0&&s(r);const a=Array.from(t).filter((function(t,e,n){return t.dataset.spollers.split(",")[0]}));if(a.length>0){const d=[];a.forEach((t=>{const e={},n=t.dataset.spollers.split(",");e.value=n[0],e.type=n[1]?n[1].trim():"max",e.item=t,d.push(e)}));let h=d.map((function(t){return"("+t.type+"-width: "+t.value+"px),"+t.value+","+t.type}));h=h.filter((function(t,e,n){return n.indexOf(t)===e})),h.forEach((t=>{const e=t.split(","),n=e[1],i=e[2],r=window.matchMedia(e[0]),a=d.filter((function(t){if(t.value===n&&t.type===i)return!0}));r.addListener((function(){s(a,r)})),s(a,r)}))}function s(t,e=!1){t.forEach((t=>{t=e?t.item:t,e.matches||!e?(t.classList.add("_init"),o(t),t.addEventListener("click",c)):(t.classList.remove("_init"),o(t,!1),t.removeEventListener("click",c))}))}function o(t,e=!0){const n=t.querySelectorAll("[data-spoller]");n.length>0&&n.forEach((t=>{e?(t.removeAttribute("tabindex"),t.classList.contains("_spoller-active")||(t.nextElementSibling.hidden=!0)):(t.setAttribute("tabindex","-1"),t.nextElementSibling.hidden=!1)}))}function c(t){const n=t.target;if(n.hasAttribute("[data-spoller]")||n.closest("[data-spoller]")){const i=n.hasAttribute("[data-spoller]")?n:n.closest("[data-spoller]"),r=i.closest("[data-spollers]"),a=!!r.hasAttribute("[data-one-spoller]");r.querySelectorAll("._slide").length||(a&&!i.classList.contains("_spoller-active")&&l(r),i.classList.toggle("_spoller-active"),e(i.nextElementSibling,500)),t.preventDefault()}}function l(t){const e=t.querySelector("[data-spoller]._spoller-active");e&&(e.classList.remove("_spoller-active"),_slideUp(e.nextElementSibling,500))}}let e=(t,e=500)=>t.hidden?((t,e=500)=>{if(!t.classList.contains("_slide")){t.classList.add("_slide"),t.hidden&&(t.hidden=!1);let n=t.offsetHeight;t.style.overflow="hidden",t.style.height=0,t.style.paddingTop=0,t.style.paddingButtom=0,t.style.marginTop=0,t.style.marginButtom=0,t.offsetHeight,t.style.transitionProperty="height, margin, padding",t.style.transitionDuration=e+"ms",t.style.height=n+"px",t.style.removeProperty("padding-top"),t.style.removeProperty("padding-buttom"),t.style.removeProperty("margin-top"),t.style.removeProperty("margin-buttom"),window.setTimeout((()=>{t.style.removeProperty("height"),t.style.removeProperty("overflow"),t.style.removeProperty("transition-duration"),t.style.removeProperty("transition-property"),t.classList.remove("_slide")}),e)}})(t,e):((t,e=500)=>{t.classList.contains("_slide")||(t.classList.add("_slide"),t.style.transitionProperty="height, margin, padding",t.style.transitionDuration=e+"ms",t.style.height=t.offsetHeight+"px",t.offsetHeight,t.style.overflow="hidden",t.style.height=0,t.style.paddingTop=0,t.style.paddingButtom=0,t.style.marginTop=0,t.style.marginButtom=0,window.setTimeout((()=>{t.hidden=!0,t.style.removeProperty("height"),t.style.removeProperty("padding-top"),t.style.removeProperty("padding-buttom"),t.style.removeProperty("margin-top"),t.style.removeProperty("margin-buttom"),t.style.removeProperty("overflow"),t.style.removeProperty("transition-duration"),t.style.removeProperty("transition-property"),t.classList.remove("_slide")}),e))})(t,e);const n=document.querySelectorAll(".menu__scroll");n.length>0&&n.forEach((t=>{t.addEventListener("click",(function(t){t.preventDefault();const e=t.target;if(e.href.includes("#")){const t=e.href.split("#")[1],n=document.querySelector("."+t);if(n){const t=n.getBoundingClientRect().top+window.pageYOffset-document.querySelector("header").offsetHeight;window.scrollTo({top:t,behavior:"smooth"})}}}))}));const i=document.getElementById("scrollUpBtn");window.addEventListener("scroll",(()=>{window.scrollY>300?i.classList.add("active"):i.classList.remove("active")})),i.addEventListener("click",(()=>{window.scrollTo({top:0,behavior:"smooth"})})),function(t){let e=new Image;1==(2==e.height)?document.querySelector("body").classList.add("webp"):document.querySelector("body").classList.add("no-webp"),e.onload=e.onerror=function(){},e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}()}new class{constructor(){this.WeatherModel=new h,this.FishingForecastModel=null,this.parentContainer=document.querySelector("#fishing-forecast-5days"),this.template=this.parentContainer.querySelector(".js-fishing-forecast-item"),this.init()}init(){document.addEventListener("DOMContentLoaded",(async()=>{await this.onDOMLoaded()}))}async onDOMLoaded(){H.init(),this.displayCurrentDate();try{document.getElementById("loading").style.display="block";const[t,e,n]=await Promise.all([m.fetchWeather(),m.fetchHistoricalData(),g.loadAll()]);this.WeatherModel.updateHistoricalData(e),this.WeatherModel.updateDailyData(t),this.FishingForecastModel=new E(n,this.WeatherModel),this.FishingForecastModel.calculateFishingForecast(),this.spollers=R()}catch(t){console.error("–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:",t),A.show(t)}finally{document.getElementById("loading").style.display="none"}}displayCurrentDate(){const t=(new Date).toLocaleDateString("ru-RU",{weekday:"long",year:"numeric",month:"long",day:"numeric"});document.querySelectorAll(".current-date").forEach((e=>{e.textContent=t}))}}})();